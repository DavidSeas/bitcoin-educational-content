---
name: OXT - Аналіз Ланцюга
description: Оволодійте основами аналізу ланцюга на Bitcoin
---
![обкладинка](assets/cover.webp)

***УВАГА:** Після арешту засновників гаманця Samourai та конфіскації їх серверів 24 квітня, **вебсайт OXT.me наразі недоступний**. Проте, існує можливість, що цей інструмент може бути перезапущений у найближчі тижні. Тим часом, ви все ще можете скористатися цим навчальним посібником, щоб зрозуміти основи аналізу ланцюга на Bitcoin. Всі евристики та шаблони, представлені тут, залишаються застосовними до транзакцій Bitcoin. Хоча ці інструменти менш оптимізовані, ніж OXT, ви тимчасово можете використовувати [Mempool.space](https://mempool.space/) або [Bitcoin Explorer](https://bitcoinexplorer.org/), щоб застосувати теоретичні концепції цієї статті на практиці.*

_Ми уважно слідкуємо за розвитком цієї справи, а також за розвитком пов’язаних інструментів. Будьте впевнені, що ми оновимо цей навчальний посібник, як тільки з'явиться нова інформація._

_Цей навчальний посібник надається лише для освітніх та інформаційних цілей. Ми не підтримуємо або заохочуємо використання цих інструментів для кримінальних цілей. Кожен користувач несе відповідальність за дотримання законів у своїй юрисдикції._

---

У цій статті ви дізнаєтесь основні теоретичні засади, необхідні для початку базового аналізу ланцюгів на Bitcoin, і, що важливіше, для розуміння того, як діють ті, хто вас спостерігає. Хоча ця стаття не є практичним навчальним посібником з інструменту OXT (тема, яку ми розглянемо в майбутньому навчальному посібнику), вона збирає набір важливих знань для його використання. Для кожної моделі, метрики та індикатора, представленого тут, надається посилання на приклад транзакції на OXT, що дозволить вам краще зрозуміти його використання та практикувати під час читання.

## Вступ
Одна з функцій грошей полягає в тому, щоб вирішити проблему подвійного збігу бажань. У системі, заснованій на бартері, для завершення обміну потрібно не лише знайти особу, яка пропонує товар, що задовольняє мою потребу, але й надати їм товар еквівалентної вартості, який задовольняє їхню власну потребу. Знайти цей баланс виявляється складним. Саме тому ми вдаємося до грошей, які дозволяють нам переміщати вартість як у просторі, так і в часі.

Для того, щоб гроші вирішували цю проблему, важливо, щоб сторона, яка надає товар або послугу, була переконана у своїй здатності витратити цю суму пізніше. Таким чином, будь-яка раціональна особа, готова прийняти шматок грошей, чи то цифровий, чи фізичний, переконається, що він відповідає двом фундаментальним критеріям:
- Монета повинна бути цілісною та автентичною;
- і вона не повинна бути витрачена двічі.

Якщо ми використовуємо фізичні гроші, то перша характеристика є найскладнішою для підтвердження. У різні періоди історії цілісність металевих монет часто піддавалася впливу практик, таких як обрізання або свердління. Наприклад, під час стародавнього Риму було поширено, що громадяни скребли краї золотих монет, щоб зібрати трохи дорогоцінного металу, при цьому зберігаючи їх для майбутніх транзакцій. Саме тому пізніше на краю монет почали відбивати канавки. Автентичність також є складною характеристикою для перевірки на фізичному грошовому носії. На сьогоднішній день техніки боротьби з підробкою стають все складнішими, змушуючи торговців інвестувати в дорогі системи верифікації.

З іншого боку, через їхню природу, подвійне витрачання не є проблемою для фізичних валют. Якщо я даю вам купюру в 10 євро, вона безповоротно залишає моє володіння, щоб увійти в ваше, тим самим виключаючи будь-яку можливість множинного витрачання грошових одиниць, які вона представляє.
Для цифрової валюти виклик інший. Забезпечення автентичності та цілісності монети часто є простішим, але забезпечення відсутності подвійних витрат є складнішим. Кожен цифровий товар по суті є інформацією. На відміну від фізичних товарів, інформація не ділиться під час обмінів, а розповсюджується шляхом множення. Наприклад, якщо я надішлю вам документ електронною поштою, він тоді дублюється. З вашого боку, ви не можете з упевненістю перевірити, що я видалив оригінальний документ.

Єдиний спосіб уникнути цього дублювання цифрового товару - бути обізнаним про всі обміни в системі. Таким чином, можна знати, хто що володіє та оновлювати рахунки всіх згідно з здійсненими транзакціями. Саме це робиться, наприклад, з книжковими грошима. Коли ви платите 10 євро торговцю кредитною карткою, банк фіксує цей обмін та оновлює реєстр.

На Bitcoin запобігання подвійним витратам відбувається таким же чином. Воно прагне підтвердити відсутність транзакції, яка вже витратила зазначені монети. Якщо ці монети ніколи не використовувались, тоді ми можемо бути впевнені, що подвійних витрат не буде. Це відома фраза від Сатоші Накамото в Білому папері: "*Єдиний спосіб підтвердити відсутність транзакції - бути обізнаним про всі транзакції.*"

На відміну від банківської моделі, на Bitcoin ми не хочемо довіряти центральній сутності. Тому всі користувачі повинні мати можливість підтвердити цю відсутність подвійних витрат, не покладаючись на третю сторону. Таким чином, кожен повинен бути обізнаним про всі транзакції Bitcoin.

Саме це публічне розповсюдження інформації ускладнює захист приватності на Bitcoin. У традиційній банківській системі, теоретично, лише фінансова установа знає про здійснені транзакції. Однак, на Bitcoin, всі користувачі інформовані про всі транзакції через їхні відповідні вузли.

Через це обмеження на розповсюдження, модель приватності Bitcoin відрізняється від тієї, що в банківській системі. У останній, транзакції асоційовані з ідентичністю користувача, але потік інформації переривається між довіреною третьою стороною та публікою. Іншими словами, ваш банкір знає, що ви купуєте вашу багету кожного ранку в місцевій пекарні, але ваш сусід не знає про всі ці транзакції. У випадку з Bitcoin, оскільки потік інформації не може бути перерваний між транзакціями та публічною сферою, модель приватності покладається на відокремлення ідентичності користувача від самих транзакцій.
![аналіз](assets/en/1.webp)
*Діаграма натхненна Сатоші Накамото в Білому папері: Bitcoin: A Peer-to-Peer Electronic Cash System, розділ 10 "Приватність".*
Оскільки транзакції Bitcoin робляться публічними, стає можливим встановлювати зв'язки між ними для виведення інформації про залучені сторони. Ця діяльність навіть становить спеціальність сама по собі, яка зазвичай називається "аналіз ланцюга". У цій статті я запрошую вас дослідити основи аналізу ланцюга, щоб зрозуміти, як відстежуються ваші біткойни.

Більшість компаній, що спеціалізуються на аналізі ланцюга, працюють як чорні скриньки і не розкривають свої методології. Тому отримати інформацію про цю практику складно. Для написання цієї статті я головним чином покладався на кілька відкритих ресурсів:
- Основна частина моєї статті взята з серії з чотирьох статей під назвою: [Understanding Bitcoin Privacy with OXT](https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-1-4-8177a40a5923), створеної Samourai Wallet у 2021 році;
- Я також використовував різні звіти від [OXT Research](https://medium.com/oxt-research), а також їх безкоштовний інструмент аналізу ланцюга;
- Ширше кажучи, мої знання походять з різних твітів та контенту від [@LaurentMT](https://twitter.com/LaurentMT) та [@ErgoBTC](https://twitter.com/ErgoBTC); - Мене також надихнув [Space Kek #19](https://podcasters.spotify.com/pod/show/decouvrebitcoin/episodes/SpaceKek-19---Analyse-de-chane--anonsets-et-entropie-e1vfuji), у якому я брав участь разом з [@louneskmt](https://twitter.com/louneskmt), [@TheoPantamis](https://twitter.com/TheoPantamis), [@Sosthene___](https://twitter.com/Sosthene___), та [@LaurentMT](https://twitter.com/LaurentMT).

Я хотів би подякувати їхнім авторам, розробникам та продюсерам. Без їхнього різноманітного контенту та програмного забезпечення ця стаття б не існувала. Я також дякую рецензентам, які ретельно виправили цей текст і обдарували мене своїми експертними порадами:
- [Gilles Cadignan](https://twitter.com/gillesCadignan);
- [Ludovic Lars](https://twitter.com/lugaxker) ([https://viresinnumeris.fr/](https://viresinnumeris.fr/)).

*Для вашої інформації, я додав технічний мініглосарій в кінці статті для визначення певних термінів. Якщо ви побачите слово, яке не розумієте з астеріском, його визначення знаходиться внизу сторінки.*

## Що таке аналіз ланцюга?
Аналіз ланцюга - це практика, яка охоплює всі методи відстеження потоків Bitcoin у блокчейні. Загалом, аналіз ланцюга ґрунтується на спостереженні характеристик у зразках попередніх транзакцій. Потім це включає ідентифікацію цих самих характеристик у транзакції, яку хочеться проаналізувати, та висновок плазмових інтерпретацій. Цей метод вирішення проблем, заснований на практичному підході до знаходження достатньо хорошого рішення, називається евристикою.

Для спрощення, аналіз ланцюга виконується у два основні кроки:
1. Ідентифікація відомих характеристик;
2. Висновок гіпотез.

Однією з цілей аналізу ланцюга є групування різних активностей на Bitcoin для визначення унікальності користувача, який їх здійснив. Після цього можна буде спробувати пов'язати цей пучок активностей з реальною ідентичністю.

Пам'ятайте моє вступне слово. Я пояснив, чому первісна модель конфіденційності Bitcoin спиралася на відокремлення ідентичності користувача від їх транзакцій. Тому може здатися, що аналіз ланцюга непотрібний, оскільки навіть якщо комусь вдається групувати активності на ланцюгу, їх не можна асоціювати з реальною ідентичністю. Теоретично, це твердження точне. Криптографічні пари ключів використовуються для встановлення умов на UTXO. По суті, ці пари ключів не розкривають жодної інформації про ідентичність їх власників. Таким чином, навіть якщо комусь вдається групувати активності, пов'язані з різними парами ключів, це не говорить нам нічого про сутність за цими активностями.
Проте практична реальність набагато складніша. Існує безліч поведінок, які ризикують пов'язати реальну ідентичність з активністю в блокчейні. У аналізі це називається точкою входу, і їх багато. Найпоширенішою, звичайно, є KYC (Know Your Customer - Знай свого клієнта). Якщо ви виводите свої біткоїни з регульованої платформи на одну з ваших особистих адрес прийому, то деякі люди можуть пов'язати вашу ідентичність з цією адресою. У ширшому сенсі, точкою входу може бути будь-яка форма взаємодії між вашим реальним життям і транзакцією в Bitcoin. Наприклад, якщо ви публікуєте адресу для отримання на своїх соціальних мережах, це може бути точкою входу для аналізу. Якщо ви робите платіж в біткоїнах своєму пекарю, він може асоціювати ваше обличчя (яке є частиною вашої ідентичності) з адресою Bitcoin.Ці точки входу майже неминучі при використанні Bitcoin. Хоча можна намагатися обмежити їхній обсяг, вони залишаться присутніми. Тому критично важливо поєднувати методи, спрямовані на збереження вашої конфіденційності. Підтримання прийнятного розділення між вашою реальною ідентичністю та вашими транзакціями є похвальним підходом, але воно залишається недостатнім. Дійсно, якщо всі ваші активності в ланцюгу можна згрупувати, то навіть найменша точка входу може поставити під загрозу єдиний рівень конфіденційності, який ви встановили.

Тому також необхідно займатися аналізом ланцюгів у нашому використанні Bitcoin. Роблячи це, ми можемо мінімізувати агрегацію наших активностей і обмежити вплив точки входу на нашу конфіденційність. Зокрема, для кращого протидії аналізу ланцюгів, що може бути кращим підходом, ніж ознайомлення з методами, що використовуються в аналізі ланцюгів? Якщо ви хочете знати, як покращити свою конфіденційність на Bitcoin, вам потрібно зрозуміти ці методи. Це дозволить вам краще зрозуміти техніки, як-от [Coinjoin](https://planb.network/en/tutorials/privacy/coinjoin-samourai-wallet) або [Payjoin](https://planb.network/en/tutorials/privacy/payjoin), і зменшити помилки, які ви могли б зробити.

У цьому ми можемо провести аналогію з криптографією та криптоаналізом. Добрий криптограф перш за все є хорошим криптоаналітиком. Щоб уявити новий алгоритм шифрування, потрібно знати, з якими атаками він зіткнеться, а також вивчати, чому попередні алгоритми були зламані. Той самий принцип застосовується до конфіденційності на Bitcoin. Розуміння методів аналізу ланцюгів є ключем до захисту від нього. Ось чому я пропоную вам цю статтю.

Важливо розуміти, що аналіз ланцюгів не є точною наукою. Він покладається на евристику, похідну від попередніх спостережень або логічних інтерпретацій. Ці правила дозволяють отримати досить надійні результати, але ніколи з абсолютною точністю. Іншими словами, аналіз ланцюгів завжди включає розмір ймовірності у висновках, які робляться. Ми можемо оцінити з більшою чи меншою впевненістю, що дві адреси належать одній і тій же сутності, але повна впевненість завжди буде недосяжною.

Ціле завдання аналізу ланцюгів полягає саме в агрегації різних евристик для мінімізації ризику помилки. Це, по суті, накопичення доказів, яке дозволяє нам наблизитися до реальності.

Ці відомі евристики можна згрупувати в різні категорії, які ми детально розглянемо разом:
- Моделі транзакцій (або моделі транзакцій);
- Внутрішні евристики до транзакції;
- Зовнішні евристики до транзакції.

Варто зазначити, що перші дві евристики на Bitcoin були сформульовані самим Сатоші Накамото. Він обговорює їх у частині 10 Білого Паперу. Як ми побачимо пізніше, цікаво спостерігати, що ці дві евристики досі зберігають превалентність в аналізі ланцюгів сьогодні. Це:
- евристика спільного володіння входом (CIOH);
- та повторне використання адреси.
Давайте разом дослідимо спостережувані характеристики та інтерпретації, які можна зробити для проведення аналізу.
## Моделі транзакцій (або шаблони транзакцій)
Модель транзакції - це просто типова модель транзакції, яку можна знайти в блокчейні, інтерпретація якої, ймовірно, відома. Вивчаючи шаблони, ми зосередимося на одній транзакції, яку ми проаналізуємо на високому рівні. Іншими словами, ми будемо дивитися лише на кількість входів та виходів, не зупиняючись на її більш специфічних деталях або її оточенні. З спостережуваної моделі ми зможемо інтерпретувати природу транзакції. Потім ми будемо шукати характеристики щодо її структури та робити висновок про інтерпретацію.

### Проста відправка (або простий платіж)
Ця модель характеризується споживанням одного або декількох UTXO як входу та створенням двох UTXO як виходу.

![аналіз](assets/en/2.webp)

Інтерпретація цієї моделі полягає в тому, що ми маємо справу з транзакцією відправлення або платежу. Користувач використав свої власні UTXO як вхід, щоб задовольнити на виході платіжний UTXO та UTXO здачі (здача повертається тому ж користувачу). Таким чином, ми знаємо, що спостережуваний користувач, ймовірно, більше не володіє одним з двох UTXO на виході (тим, що призначений для платежу), але все ще володіє іншим UTXO (тим, що є здачею).

На цьому етапі нам неможливо вказати, який вихід представляє який UTXO, оскільки це не є метою цієї моделі. Ми зможемо це зробити, спираючись на евристику, яку ми вивчатимемо в наступній частині. На цьому етапі наша мета обмежена ідентифікацією природи запитуваної транзакції, яка в цьому випадку є простою відправкою.

Наприклад, ось транзакція Bitcoin, яка використовує модель простої відправки:
### Згортання ("sweep" англійською)
Ця модель характеризується споживанням одного UTXO як входу та створенням одного UTXO як виходу.

![аналіз](assets/en/3.webp)

Інтерпретація цієї моделі полягає в тому, що ми маємо справу з самопереказом. Користувач перевів свої біткоїни самому собі на іншу адресу, якою він володіє. Оскільки в транзакції немає здачі, дуже малоймовірно, що ми маємо справу з платежем. Тоді ми знаємо, що спостережуваний користувач, ймовірно, все ще володіє цим UTXO.

Наприклад, ось транзакція Bitcoin, яка використовує модель згортання:
[35f1072a0fda5ae106efb4fda871ab40e1f8023c6c47f396441ad4b995ea693d](https://mempool.space/tx/35f1072a0fda5ae106efb4fda871ab40e1f8023c6c47f396441ad4b995ea693d)

Однак, цей тип шаблону також може виявити самопереказ на рахунок біржі (платформа обміну криптовалют). Дослідження відомих адрес та контексту транзакції дозволить нам знати, чи є це згортанням до гаманця самообслуговування або виведенням на платформу.

### Консолідація
Ця модель характеризується споживанням кількох UTXO як входу та створенням одного UTXO як виходу.

![аналіз](assets/en/4.webp)
Інтерпретація цієї моделі полягає в тому, що ми маємо справу з консолідацією. Це поширена практика серед користувачів Bitcoin, яка має на меті об'єднання кількох UTXO в очікуванні можливого зростання комісій за транзакції. Виконуючи цю операцію в період, коли комісії низькі, можна заощадити на майбутніх витратах.
Ми можемо зробити висновок, що користувач, який стоїть за цією транзакцією, ймовірно, володів усіма UTXO на вході і все ще володіє UTXO на виході. Отже, це, безумовно, самопереказ.

Так само, як і при випадку з "sweep", цей тип шаблону також може вказувати на самопереказ на рахунок обміну. Це буде дослідження відомих адрес і контексту транзакції, яке дозволить нам знати, чи є це консолідацією до гаманця самообслуговування або виведенням на платформу.

Наприклад, ось транзакція Bitcoin, яка використовує шаблон консолідації:
[77c16914211e237a9bd51a7ce0b1a7368631caed515fe51b081d220590589e94](https://mempool.space/tx/77c16914211e237a9bd51a7ce0b1a7368631caed515fe51b081d220590589e94)
### Модель пакетного витрачання
Ця модель характеризується використанням кількох UTXO на вході (часто лише одного) і створенням багатьох UTXO на виході.

![аналіз](assets/en/5.webp)

Інтерпретація цієї моделі полягає в тому, що ми маємо справу з пакетним витрачанням. Це практика, яка, ймовірно, вказує на значну економічну активність, наприклад, обмін. Пакетне витрачання дозволяє цим суб'єктам заощаджувати на комісіях, об'єднуючи свої витрати в одну транзакцію.

Ми можемо зробити висновок, що вхідний UTXO походить від компанії зі значною економічною активністю, а вихідні UTXO будуть розподілені. Деякі з них належатимуть клієнтам компанії. Інші можуть піти до партнерських компаній. Нарешті, безумовно, буде здача, яка повернеться випускаючій компанії.

Наприклад, ось транзакція Bitcoin, яка використовує шаблон пакетного витрачання:
[8a7288758b6e5d550897beedd13c70bcbaba8709af01a7dbcc1f574b89176b43](https://mempool.space/tx/8a7288758b6e5d550897beedd13c70bcbaba8709af01a7dbcc1f574b89176b43)

### Транзакції, специфічні для протоколу
Серед шаблонів транзакцій ми також можемо ідентифікувати моделі, які вказують на використання конкретного протоколу. Наприклад, Whirlpool coinjoins матимуть легко ідентифіковану структуру, яка дозволяє їх відрізняти від інших класичних транзакцій.

![аналіз](assets/en/6.webp)

Аналіз цього шаблону дає підстави припустити, що ми, ймовірно, маємо справу з колаборативною транзакцією. Також можливо спостерігати coinjoin. Якщо ця остання гіпотеза виявиться точною, то кількість виходів може надати нам приблизну оцінку кількості учасників.

Наприклад, ось транзакція Bitcoin, яка використовує шаблон колаборативного типу транзакції coinjoin:
[00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea](https://mempool.space/tx/00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea)
Існує багато інших протоколів, які мають свої специфічні структури. Таким чином, ми можемо відрізняти транзакції типу Wabisabi або транзакції Stamps, наприклад.
## Евристики внутрішніх транзакцій
Внутрішня евристика - це специфічна характеристика, ідентифікована в межах самої транзакції, без необхідності аналізувати її оточення, що дозволяє нам робити висновки. На відміну від патернів, які зосереджені на загальній структурі транзакції, внутрішні евристики базуються на наборі даних, які можна витягнути. Це включає:
- Розміри різних UTXO, як вхідних, так і вихідних;
- Все, що пов'язано зі скриптами: адреси отримувачів, версіонування, locktimes...

Загалом, цей тип евристики дозволяє нам ідентифікувати зміну в конкретній транзакції. Роблячи це, ми можемо продовжувати відстежувати сутність через кілька різних транзакцій.

Ще раз нагадую, що ці евристики не є абсолютно точними. Взяті окремо, вони лише дозволяють ідентифікувати ймовірні сценарії. Це накопичення кількох евристик, яке сприяє зменшенню невизначеності, не виключаючи її повністю.

### Внутрішні схожості
Ця евристика передбачає вивчення схожостей між входами та виходами однієї та тієї ж транзакції. Якщо однакова характеристика спостерігається на входах і лише на одному з виходів транзакції, то ймовірно, що цей вихід є зміною.

Найбільш очевидною характеристикою є повторне використання адреси отримувача в одній і тій же транзакції.

![аналіз](assets/en/7.webp)

Ця евристика залишає мало місця для сумнівів. Якщо їхній приватний ключ не був скомпрометований, одна й та ж адреса отримувача неминуче виявляє активність одного користувача. Висновок, що слідує, полягає в тому, що зміна транзакції - це вихід з тією ж адресою, що й вхід. Це дозволяє нам продовжувати відстежувати особу з цієї зміни.

Наприклад, ось транзакція, де цю евристику, ймовірно, можна застосувати:
[54364146665bfc453a55eae4bfb8fdf7c721d02cb96aadc480c8b16bdeb8d6d0](https://mempool.space/tx/54364146665bfc453a55eae4bfb8fdf7c721d02cb96aadc480c8b16bdeb8d6d0)

Ці схожості між входами та виходами не обмежуються лише повторним використанням адрес. Будь-яка схожість у використанні скриптів може дозволити застосування евристики. Наприклад, іноді можна спостерігати однакове версіонування між входом і одним з виходів транзакції.

![аналіз](assets/en/8.webp)
На цій діаграмі ми бачимо, що вхід номер 0 розблокує скрипт P2WPKH (SegWit V0, що починається з "bc1q"). Вихід номер 0 використовує той самий тип скрипта. Однак, вихід номер 1 використовує скрипт P2TR (SegWit V1, що починається з "bc1p"). Інтерпретація цієї характеристики полягає в тому, що ймовірно адреса з тим самим версіонуванням, що й вхід, є адресою зміни. Отже, вона все ще належить тому самому користувачу.
Ось транзакція, де цю евристику, ймовірно, можна застосувати:
[db07516288771ce5d0a06b275962ec4af1b74500739f168e5800cbcb0e9dd578](https://mempool.space/tx/db07516288771ce5d0a06b275962ec4af1b74500739f168e5800cbcb0e9dd578)
У цій транзакції ми можемо побачити, що вхідний номер 0 та вихідний номер 1 використовують скрипти P2WPKH (SegWit V0), тоді як вихідний номер 0 використовує інший тип скрипта, P2PKH (Legacy).
### Платежі Круглими Сумами
Інша внутрішня евристика, яка може допомогти нам ідентифікувати решту, це круглі суми. Загалом, коли ми маємо справу з простим шаблоном платежу (1 вхід і 2 виходи), якщо один з виходів витрачає круглу суму, то це представляє платіж.

![аналіз](assets/en/9.webp)

Методом виключення, якщо один вихід представляє платіж, інший представляє решту. Таким чином, ми можемо інтерпретувати, що ймовірно користувач на вході все ще володіє виходом, ідентифікованим як решта.

Слід зазначити, що ця евристика не завжди застосовна, оскільки більшість платежів все ще здійснюється в одиницях фіатної валюти. Дійсно, коли торговець у Франції приймає біткойни, зазвичай, вони не вказують стабільні ціни в сатах. Вони б скоріше вибрали конвертацію між ціною в євро та сумою в біткойнах, яка має бути сплачена. Тому в виході транзакції не повинно бути круглої суми. Проте аналітик міг би спробувати виконати цю конвертацію, враховуючи курс обміну, який діяв, коли транзакція була трансльована в мережі.

Якщо одного дня біткойн стане переважною одиницею обліку в наших обмінах, ця евристика могла б стати ще кориснішою для аналізу.

Наприклад, ось транзакція, де цю евристику, ймовірно, можна застосувати:
### Великий Витрат

Коли помічається достатньо велика різниця між двома виходами транзакції в простій моделі платежу, можна оцінити, що більший вихід, ймовірно, є рештою.

![аналіз](assets/en/10.webp)

Ця евристика найбільшого виходу, ймовірно, є найменш точною з усіх. Якщо вона ідентифікована сама по собі, вона досить слабка. Однак, ця характеристика може бути поєднана з іншими евристиками для зменшення невизначеності нашої інтерпретації.

Наприклад, якщо ми розглядаємо транзакцію, яка має вихід з круглою сумою та інший вихід з більшою сумою, спільне застосування евристики круглих платежів та тієї, що стосується найбільшого виходу, дозволяє нам зменшити наш рівень невизначеності.

Наприклад, ось транзакція, де цю евристику, ймовірно, можна застосувати:
[b79d8f8e4756d34bbb26c659ab88314c220834c7a8b781c047a3916b56d14dcf](https://mempool.space/tx/b79d8f8e4756d34bbb26c659ab88314c220834c7a8b781c047a3916b56d14dcf)

## Зовнішні Евристики до Транзакції
Вивчення зовнішніх евристик - це аналіз схожостей, шаблонів та характеристик певних елементів, які не є властивими самій транзакції. Іншими словами, якщо раніше ми обмежувалися використанням елементів, властивих транзакції з внутрішніми евристиками, тепер ми розширюємо наше поле аналізу до середовища транзакції завдяки зовнішнім евристикам.

### Повторне Використання Адреси
Це одна з найвідоміших евристик серед біткойнерів. Повторне використання адреси дозволяє встановити зв'язок між різними транзакціями та різними UTXO. Це спостерігається, коли адреса для отримання біткойнів використовується кілька разів.

Інтерпретація повторного використання адреси полягає в тому, що всі UTXO, заблоковані на цій адресі, належать (або належали) одній і тій же сутності. Ця евристика залишає мало місця для невизначеності. Коли вона ідентифікована, інтерпретація, що слідує, має велику ймовірність відповідати дійсності.
Як пояснено в інтродукції, цю евристику відкрив сам Сатоші Накамото. У Білому Папері він конкретно згадує рішення, щоб запобігти виробництву користувачами, яке полягає просто у використанні нової адреси для кожної нової транзакції: "*Як додатковий захисний бар'єр, для кожної транзакції можна використовувати нову пару ключів, щоб вони не були пов'язані зі спільним власником.*"
Наприклад, ось адреса, яка використовується в кількох транзакціях:
[bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0](https://mempool.space/address/bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0)

### Схожість Скриптів та Відбитків Гаманців
Окрім повторного використання адрес, існує багато інших евристик, які можуть пов'язати дії з тим самим гаманцем або з кластером адрес.

По-перше, аналітик може використовувати схожості у використанні скриптів. Наприклад, певні меншинні скрипти, як-от multisig, можуть бути легше помічені, ніж скрипти SegWit V0. Чим більша група, в якій ми ховаємося, тим важче нас помітити. Саме тому, у протоколі Coinjoin Whirlpool, всі учасники використовують абсолютно однаковий тип скрипту.

Більш широко, аналітик також може зосередитися на характерних відбитках гаманця. Це специфічні процеси використання, які можна намагатися ідентифікувати для їх використання як евристик слідкування. Іншими словами, якщо спостерігається накопичення однакових внутрішніх характеристик у транзакціях, приписаних до відстежуваної сутності, можна спробувати ідентифікувати ці самі характеристики на інших транзакціях.

Наприклад, можна ідентифікувати, що відстежуваний користувач систематично відправляє свою решту на адреси P2TR* (bc1p…). Якщо цей процес повторюється, його можна використовувати як евристику для продовження нашого аналізу. Інші відбитки також можуть бути використані, такі як порядок UTXO, розміщення решти у виходах, сигналізація RBF (Replace-by-Fee), або навіть номер версії та locktime.
Як [@LaurentMT](https://twitter.com/LaurentMT) уточнює в [Space Kek #19](https://podcasters.spotify.com/pod/show/decouvrebitcoin/episodes/SpaceKek-19---Analyse-de-chane--anonsets-et-entropie-e1vfuji) (франкомовний подкаст), користь відбитків гаманців у аналізі ланцюгів значно зростає з часом. Дійсно, зростаюча кількість типів скриптів і все більш поступове впровадження цих нових функцій програмним забезпеченням гаманців підкреслює відмінності. Навіть трапляється, що можна точно ідентифікувати програмне забезпечення, використане відстежуваною сутністю. Тому важливо розуміти, що вивчення відбитка гаманця особливо актуально для недавніх транзакцій, більше ніж для тих, що були ініційовані на початку 2010-х.
Підсумовуючи, відбиток може бути будь-якою конкретною практикою, виконаною автоматично гаманцем або вручну користувачем, яка може бути знайдена на інших транзакціях для допомоги в нашому аналізі.

### CIOH
CIOH, або "Common Input Ownership Heuristic," що може бути перекладено як "евристика спільного володіння входами" або "евристика спільного витрачання," є евристикою, яка стверджує, що коли транзакція має кілька входів, ці входи, ймовірно, всі належать одній сутності. Отже, їх володіння є спільним.
Щоб застосувати CIOH, спочатку потрібно спостерігати транзакцію, яка має кілька входів. Це може бути два входи, так і тридцять входів. Як тільки ця характеристика виявлена, потрібно перевірити, чи не вписується транзакція в якийсь відомий шаблон. Наприклад, якщо вона має 5 входів приблизно з однаковою сумою і 5 виходів з точно такою ж сумою, ми знаємо, що це структура Coinjoin Whirlpool. Отже, CIOH не може бути застосований.
Однак, якщо транзакція не вписується в жоден відомий шаблон спільної транзакції, то можна інтерпретувати, що всі входи, ймовірно, належать одній і тій же сутності. Це може бути дуже корисним для розширення вже відомого кластера або для продовження відстеження.

![аналіз](assets/en/11.webp)

CIOH було відкрито Сатоші Накамото. Він обговорює це в частині 10 Білого Паперу: "*[...] зв'язок неминучий з транзакціями з кількома входами, які обов'язково вказують на те, що їхні входи належали одному власнику. Ризик полягає в тому, що якщо власник ключа буде розкритий, зв'язки можуть виявити інші транзакції, які належали тому ж власнику.*"
Особливо захоплює те, що Сатоші Накамото, навіть до офіційного запуску Bitcoin, вже визначив дві основні проблеми конфіденційності для користувачів, а саме CIOH та повторне використання адрес. Таке передбачення є досить вражаючим, оскільки ці дві евристики залишаються, навіть сьогодні, найбільш корисними в аналізі ланцюга.

### Дані поза ланцюгом
Очевидно, аналіз ланцюга не обмежується лише даними в ланцюгу. Будь-які дані з попереднього аналізу або доступні в Інтернеті також можуть бути використані для уточнення аналізу.

Наприклад, якщо спостерігається, що відстежувані транзакції систематично транслюються з одного вузла Bitcoin і можна ідентифікувати його IP-адресу, можливо, вдасться виявити інші транзакції від тієї ж сутності.

Аналітик також має можливість покладатися на аналізи, які раніше були опубліковані як відкритий код, або на свої власні попередні аналізи. Можливо, вдасться знайти вихід, який вказує на кластер адрес, який вже був ідентифікований. Іноді також можливо покладатися на виходи, які вказують на біржу, адреси цих платформ зазвичай відомі.

Аналогічно, можна провести аналіз методом виключення. Наприклад, якщо під час аналізу транзакції з двома виходами один з них пов'язаний з відомим, але відмінним кластером адрес від відстежуваної сутності, то можна інтерпретувати, що інший вихід, ймовірно, представляє решту.

Аналіз ланцюга також включає частину OSINT (Open Source Intelligence), яка є трохи більш загальною з пошуками в Інтернеті. Саме тому не рекомендується публікувати адреси для отримання безпосередньо в соціальних мережах або на вебсайті, чи то під псевдонімом, чи ні.

### Тимчасові моделі
Можливо, ви не одразу подумаєте про це, але певні людські поведінки можна впізнати в ланцюгу. Найкориснішим у дослідженні є ваш шаблон сну! Так, коли ви спите, ви, ймовірно, не транслюєте транзакції Bitcoin. Оскільки ви зазвичай спите приблизно в одні й ті ж години, тимчасові аналізи є поширеними в аналізі ланцюга. Це просто передбачає запис часу, коли транзакції даної сутності транслюються в мережу Bitcoin. Аналіз цих тимчасових шаблонів дозволяє вивести численні відомості.
Перш за все, тимчасовий аналіз іноді може ідентифікувати природу відстежуваної сутності. Якщо спостерігається, що транзакції транслюються послідовно протягом 24 годин, це може вказувати на сильну економічну активність. Сутність за цими транзакціями, ймовірно, є бізнесом, потенційно міжнародним, і, можливо, з автоматизованими процедурами внутрішньо.
Наприклад, я помітив цей патерн кілька тижнів тому, аналізуючи транзакцію, в якій помилково було виділено 19 біткоїнів на комісії. Простий часовий аналіз дозволив мені припустити, що ми маємо справу з автоматизованим сервісом, а отже, ймовірно, з великою сутністю, такою як біржа: https://twitter.com/Loic_Pandul/status/1701127409712452072
Дійсно, через кілька днів було виявлено, що кошти належали PayPal через біржу Paxos.

Навпаки, якщо ми бачимо, що часовий патерн розподілений протягом 16 конкретних годин, то можна оцінити, що ми маємо справу з індивідуальним користувачем або, можливо, з місцевим бізнесом залежно від обсягів обміну.

Понад природу спостережуваної сутності, часовий патерн також може дати нам приблизне місцезнаходження користувача. Таким чином, ми можемо корелювати інші транзакції та використовувати часову мітку цих як додаткову евристику, яку можна додати до нашого аналізу.

Наприклад, на адресі, яку я згадував раніше і яка використовувалася кілька разів, можна спостерігати, що транзакції, незалежно від того, вхідні вони чи вихідні, зосереджені протягом 13-годинного інтервалу.
![аналіз](assets/notext/12.webp)
*Авторство: OXT*

Цей інтервал, ймовірно, відповідає Європі, Африці або Близькому Сходу. Отже, можна інтерпретувати, що користувач за цими транзакціями живе там.

У іншому реєстрі, це також часовий аналіз цього типу, який дозволив висунути гіпотезу, що Сатоші Накамото не працював з Японії, а насправді зі Сполучених Штатів: [https://medium.com/@insearchofsatoshi/the-time-zones-of-satoshi-nakamoto-aa40f035178f](https://medium.com/@insearchofsatoshi/the-time-zones-of-satoshi-nakamoto-aa40f035178f)

### Аналіз обсягів
Інша зовнішня евристика, яку можна використовувати, - це аналіз торгових обсягів. Виходячи з сум, присутніх у кожній транзакції, приписаній сутності, ця інформація може бути використана як додаткова евристика для решти аналізу.
Ця евристика, звичайно, досить слабка, але вона може допомогти зменшити невизначеність, коли додана до інших евристик.

## Як захистити себе від аналізу ланцюга?
Як користувач Bitcoin, ви маєте право захищати свою приватність. Це випливає з ваших природних прав володіти собою та розпоряджатися собою, які притаманні кожній особі, незалежно від будь-яких законодавчих обмежень.

Це природне право на захист приватності також перетворюється на вимогу-право, закріплене в статті 12 Всесвітньої декларації прав людини, яка зазначає, що "*Ніхто не повинен піддаватися свавільному втручанню в його приватне життя, сім'ю, дім чи кореспонденцію, ні нападам на його честь та репутацію. Кожен має право на захист закону від такого втручання або нападів.*".

Однак основна діяльність компаній, що спеціалізуються на аналізі ланцюгів, полягає саме у втручанні у вашу приватну сферу, таким чином порушуючи конфіденційність вашої кореспонденції. Хоча можна було б сподіватися, що, відповідно до зазначеного вимоги-права, держави енергійно захищали б нашу приватність, вони не тільки знехтували цим, але й суттєво фінансують фінансування цих аналітичних компаній. Також було б марно сподіватися на підтримку від галузевих асоціацій, які, здається, готові піти на всі поступки перед законодавцем.

Де-факто, це вимога-право на приватність в Bitcoin не існує. Тому саме вам, користувачу, слід заявити про своє природне право та захистити конфіденційність вашої кореспонденції. Це включає в себе застосування різних технік та практик використання, які дозволять вам запобігти або обдурити евристики, використовувані для аналізу ланцюгів.

### Уникнення попадання в евристики
Перш за все, перед тим як розглядати більш радикальні методи, радимо максимально обмежити нашу вразливість до евристик, які використовуються для аналізу ланцюгів. Як було зазначено раніше, дві найпотужніші евристики - це повторне використання адрес та COINJOIN.
Основний принцип забезпечення вашої конфіденційності в Bitcoin полягає у використанні нової, чистої адреси для кожної вхідної транзакції до вашого гаманця. Повторне використання адрес дійсно є головною загрозою конфіденційності в Bitcoin.
Для окремого користувача генерація нової адреси для кожного вхідного платежу є дуже простою. Сучасні гаманці роблять це автоматично, як тільки ви натискаєте "Отримати". Таким чином, якщо ви надаєте хоча б найменше значення конфіденційності ваших транзакцій, використання свіжих адрес є абсолютним мінімумом. Якщо вам коли-небудь знадобиться статична точка контакту в інтернеті, замість того, щоб вказувати адресу для отримання, ви можете використовувати рішення [як PayNym, що реалізує BIP47](https://planb.network/en/tutorials/privacy/paynym-bip47).
Далі, якщо ви хочете діяти проти аналізу ланцюгів, уникайте об'єднання UTXO на вході транзакції. Як мінімум, якщо вам дійсно потрібно об'єднати, віддайте перевагу UTXO, які мають одне і те ж джерело. Ця рекомендація передбачає наявність гарного управління вашими UTXO. При купівлі ваших біткойнів віддавайте перевагу переказам, що включають великі суми, щоб максимізувати кількість платежів, які ви можете здійснити без необхідності об'єднання. Я також раджу вам маркувати ваші UTXO у вашому програмному забезпеченні, щоб ідентифікувати їхнє походження та уникати об'єднання з різних джерел.

Ширше кажучи, для всіх інших евристик, вам потрібно знати їх, щоб намагатися не потрапляти в них:
- Не використовуйте міноритарні скрипти. Віддайте перевагу SegWit V0 або можливо SegWit V1;
- Не робіть платежі круглими сумами. Наприклад, якщо вам потрібно відправити 100k sats другові, відправте їм 114,486 sats. Вони куплять вам напій у відповідь;
- Намагайтеся не мати завжди решту, яка набагато більша, ніж сума платежу;
- Не публікуйте ваші адреси для отримання в соціальних мережах;
- Використовуйте власний вузол під Tor для трансляції ваших транзакцій;
- Намагайтеся не транслювати ваші транзакції Bitcoin завжди в один і той же час…

### Використання інструментів конфіденційності
Ви також можете звернутися до методів, які роблять ваше використання Bitcoin неоднозначним, щоб запобігти або ввести в оману аналіз ланцюгів.

Найпопулярніша техніка, безсумнівно, Coinjoin, структура спільної транзакції, яка мобілізує кілька UTXO однакових сум. Мета тут полягає в тому, щоб розірвати детерміновані зв'язки, таким чином запобігаючи аналізам від теперішнього до минулого і від минулого до теперішнього. Coinjoin дозволяє створити правдоподібне заперечення, приховуючи ваші монети серед великої групи нерозрізнених монет. Якщо ви хочете дізнатися більше про Coinjoin, як з технічної, так і з практичної точки зору, я пропоную вам прочитати ці інші статті та навчальні посібники:
- [COINJOIN - SAMOURAI WALLET](https://planb.network/en/tutorials/privacy/coinjoin-samourai-wallet);
- [COINJOIN - SPARROW WALLET](https://planb.network/en/tutorials/privacy/coinjoin-sparrow-wallet);
- [WHIRLPOOL STATS TOOLS - ANONSETS](https://planb.network/en/tutorials/privacy/wst-anonsets).
![аналіз](assets/en/13.webp)

CoinJoin є відмінним інструментом для створення правдоподібного заперечення для монет, але він не оптимізований для всіх потреб конфіденційності користувачів. Зокрема, CoinJoin не був розроблений для використання як інструмент оплати. Він дуже жорсткий щодо сум, що обмінюються, щоб удосконалити створення правдоподібного заперечення. Оскільки не можна вільно вибирати суму вихідних транзакцій, CoinJoin не можна використовувати для здійснення платежів в біткойнах.
Наприклад, уявіть, що я хочу заплатити за свою багету біткоїнами, оптимізуючи свою конфіденційність. Враховуючи неможливість вибору кількості результуючого UTXO з CoinJoin, я опинився б не в змозі налаштувати суму моїх витрат до ціни, встановленої пекарем. Тому CoinJoin виявляється недостатнім для платіжних транзакцій.
Інші інструменти були розроблені, щоб задовольнити потреби в конфіденційності в більш специфічних випадках використання. Наприклад, ми маємо [PayJoin](https://planb.network/en/tutorials/privacy/payjoin), свого роду міні-CoinJoin, який залучає лише двох учасників і базується на структурі, що дозволяє здійснювати платіж.

Унікальність PayJoin полягає в його здатності створювати транзакцію, яка виглядає звичайною, тоді як насправді це міні-CoinJoin між двома користувачами. У цій структурі одержувач транзакції бере участь серед вхідних даних разом з фактичним відправником. Таким чином, одержувач вставляє платіж собі в межах транзакції, яка сприяє фактичному платежу.

Наприклад, якщо ви купуєте багет у свого пекаря за 6,000 сатоші з UTXO на 10,000 сатоші, і ви хочете зробити PayJoin, ваш пекар додасть UTXO на 15,000 сатоші, яке належить їм, як вхід до вашої оригінальної транзакції, яку вони повністю відновлять як вихід, щоб обдурити евристику:

![аналіз](assets/en/14.webp)

Комісії за транзакції ігноруються для спрощення розуміння схеми.

Цілі PayJoin двоякі. По-перше, він прагне обдурити зовнішнього спостерігача, створюючи приманку через COH. Дійсно, коли аналітик спостерігає за цією транзакцією, вони думатимуть, що можуть застосувати COH, і таким чином припустять спільне володіння різними входами. Насправді, це припущення невірне, оскільки один вхід належить відправнику, тоді як інший належить одержувачу. Таким чином, PayJoin псує аналіз ланцюга, ведучи аналітика неправильним шляхом.
Друга ціль PayJoin - обдурити аналітика щодо фактичної суми транзакції, завдяки специфічній структурі його виходів. Таким чином, PayJoin входить в область стеганографії. Він дозволяє приховати реальну суму транзакції в межах обманної транзакції.

Дійсно, якщо ми повернемося до нашого прикладу використання PayJoin для купівлі багети, зовнішній спостерігач може подумати, що ми маємо справу з платежем на 4,000 сатоші або 21,000 сатоші. Насправді платіж за багету становить 6,000 сатоші: 21,000 - 15,000 = 6,000. Реальна вартість платежу, отже, прихована в межах фальшивого платежу, який діє як приманка для аналізу ланцюга.

Понад PayJoin та CoinJoin, існує багато інших структур транзакцій Bitcoin, які або блокують аналіз ланцюга, або обманюють його. Серед них я міг би згадати транзакції [Stonewall](https://planb.network/en/tutorials/privacy/stonewall) та [StonewallX2](https://planb.network/en/tutorials/privacy/stonewall-x2), які дозволяють або зробити гнучкий міні Coinjoin, або імітувати гнучкий міні Coinjoin. Також існують транзакції [Ricochet](https://planb.network/en/tutorials/privacy/ricochet), які симулюють зміну власності біткоїнів, роблячи безліч фальшивих переказів самому собі.

Всі ці інструменти доступні в Samourai Wallet на мобільних пристроях та Sparrow Wallet на ПК. Якщо ви хочете дізнатися більше про ці специфічні структури транзакцій, я раджу вам ознайомитися з моїми навчальними матеріалами:
- [PAYJOIN](https://planb.network/en/tutorials/privacy/payjoin);
- [PAYJOIN - SAMOURAI WALLET](https://planb.network/en/tutorials/privacy/payjoin-samourai-wallet);
- [PAYJOIN - SPARROW WALLET](https://planb.network/en/tutorials/privacy/payjoin-sparrow-wallet);
- [STONEWALL](https://planb.network/en/tutorials/privacy/stonewall);
- [STONEWALL X2](https://planb.network/en/tutorials/privacy/stonewall-x2);
- [RICOCHET](https://planb.network/en/tutorials/privacy/ricochet).

## Висновок
Аналіз ланцюга - це практика, яка полягає у спробі простежити потік біткойнів у ланцюгу. Для цього аналітики шукають патерни та характеристики, щоб висунути більш-менш правдоподібні гіпотези та інтерпретації.

Точність цих евристик варіюється: деякі надають вищий ступінь впевненості, ніж інші, але жодна не може стверджувати, що є непомильною. Однак, накопичення кількох збігаючихся евристик може пом'якшити цей вроджений сумнів, хоча повністю усунути його неможливо.
Ми можемо категоризувати ці методи на три відмінні основні категорії:
- Патерни, зосереджені на загальній структурі кожної транзакції;
- Внутрішні евристики, які дозволяють вичерпно розглянути всі деталі транзакції, не розширюючи її контекст;
- Зовнішні евристики, які охоплюють аналіз транзакції в її середовищі, а також будь-які зовнішні дані, які можуть надати уявлення.

Як користувачу Bitcoin, важливо оволодіти основними принципами аналізу ланцюга, щоб ефективно йому протидіяти та таким чином захистити свою конфіденційність.

## Технічний міні-глосарій:
**P2PKH:** абревіатура для Pay to Public Key Hash. Це стандартна модель скрипта, яка використовується для встановлення умов витрати на UTXO. Вона дозволяє блокувати біткойни на хеші публічного ключа, тобто на адресі отримувача. Цей скрипт асоціюється зі стандартом Legacy і був введений у перших версіях Bitcoin Сатоші Накамото. На відміну від P2PK, де публічний ключ явно включений у скрипт, P2PKH використовує криптографічний відбиток публічного ключа з деякими метаданими, також називаними "адресою отримувача". Цей скрипт включає хеш RIPEMD160 від SHA256 публічного ключа та стверджує, що для доступу до коштів отримувач має надати публічний ключ, який відповідає цьому хешу, а також дійсний цифровий підпис, створений з асоційованого приватного ключа. Адреси P2PKH кодуються за допомогою формату Base58Check, що надає їм стійкість до помилок у друку через використання контрольної суми. Ці адреси завжди починаються з цифри 1.
**P2TR:** акронім для Pay to Taproot ("платіж до кореня"). Це стандартна модель скрипта, що використовується для встановлення умов витрат на UTXO. P2TR було введено з реалізацією Taproot у листопаді 2021 року. Вона використовує протокол Schnorr для агрегації криптографічних ключів, а також дерева Меркла для альтернативних скриптів, відомих як MAST (Merkelized Alternative Script Tree). На відміну від традиційних транзакцій, де умови витрат публічно відкриті (іноді при отриманні, іноді при витраті), P2TR дозволяє приховувати складні скрипти за єдиним видимим публічним ключем. Технічно скрипт P2TR блокує біткоїни на унікальному публічному ключі Schnorr, позначеному як K. Однак, цей ключ K насправді є агрегатом публічного ключа P та публічного ключа M, останній з яких розраховується з кореня Меркла списку ScriptPubKeys. Агрегація ключів виконується за допомогою протоколу підпису Schnorr. Біткоїни, заблоковані за допомогою скрипта P2TR, можна витратити двома різними способами: або опублікувавши підпис для публічного ключа P, або задовольнивши один зі скриптів, що містяться в дереві Меркла. Перший варіант називається "шлях ключа", а другий - "шлях скрипта". Таким чином, P2TR дозволяє користувачам відправляти біткоїни або на публічний ключ, або на кілька скриптів на їх вибір. Ще одна перевага цього скрипта полягає в тому, що, хоча існує кілька способів витратити вихід P2TR, потрібно розкрити лише той, який використовується при витраті, дозволяючи не використаним альтернативам залишатися приватними. Наприклад, завдяки агрегації ключів Schnorr, публічний ключ P сам може бути агрегованим ключем, потенційно представляючи мультіпідпис. P2TR є вихідним SegWit версії 1, що означає, що підписи для входів P2TR зберігаються у свідку транзакції, а не в ScriptSig. Адреси P2TR використовують кодування Bech32m і починаються з bc1p.

**P2WPKH:** Акронім для Pay to Witness Public Key Hash. Це стандартна модель скрипта, що використовується для встановлення умов витрат на UTXO. P2WPKH було введено з реалізацією SegWit у серпні 2017 року. Цей скрипт схожий на P2PKH (Pay to Public Key Hash), оскільки він також блокує біткоїни на основі хешу публічного ключа, тобто адреси отримувача. Різниця полягає в тому, як підписи та скрипти включені в транзакцію. У випадку P2WPKH інформація про скрипт підпису (ScriptSig) переміщується з традиційної структури транзакції в окремий розділ, названий Witness. Цей крок є особливістю оновлення SegWit (Segregated Witness). Ця техніка має перевагу в зменшенні розміру даних транзакції в основному тілі, зберігаючи при цьому необхідну інформацію про скрипт для перевірки в окремому розділі. Відповідно, транзакції P2WPKH, як правило, менш витратні з точки зору комісій порівняно з традиційними транзакціями. Адреси P2WPKH записуються за допомогою кодування Bech32, що сприяє більш лаконічному та менш схильному до помилок написанню завдяки контрольній сумі BCH. Ці адреси завжди починаються з bc1q, що робить їх легко відрізними від традиційних адрес отримувачів. P2WPKH є вихідним SegWit версії 0.
**UTXO:** Акронім для Невитрачений Вихід Транзакції. UTXO - це вихід транзакції, який ще не був витрачений або використаний як вхід для нової транзакції. UTXO представляють частку біткойнів, які належать користувачу і які в даний момент доступні для витрати. Кожен UTXO асоційований зі специфічним вихідним скриптом, який визначає необхідні умови для витрати біткойнів. Транзакції в Біткойні використовують ці UTXO як входи та створюють нові UTXO як виходи. Модель UTXO є фундаментальною для Біткойна, оскільки вона дозволяє легко перевіряти, що транзакції не намагаються витратити біткойни, які не існують або вже були витрачені. По суті, UTXO - це частка Біткойна.