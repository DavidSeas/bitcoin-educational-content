---
name: Payjoin
description: Що таке Payjoin у Bitcoin?
---
![Мініатюра Payjoin - стеганографія](assets/cover.webp)

***УВАГА:** Після арешту засновників Samourai Wallet та конфіскації їх серверів 24 квітня, Payjoins Stowaway у Samourai Wallet функціонує лише шляхом ручного обміну PSBT між зацікавленими сторонами, за умови, що обидва користувачі підключені до власного Dojo. Що стосується Sparrow, Payjoins через BIP78 все ще працюють. Однак, можливо, що ці інструменти будуть перезапущені в найближчі тижні. Тим часом, ви все ще можете прочитати цю статтю, щоб зрозуміти теоретичні основи функціонування payjoins.*

_Ми уважно слідкуємо за розвитком цієї справи, а також за розвитком пов'язаних інструментів. Будьте впевнені, що ми оновимо цей навчальний посібник, як тільки з'явиться нова інформація._

_Цей навчальний посібник надається лише для освітніх та інформаційних цілей. Ми не підтримуємо або заохочуємо використання цих інструментів для злочинних цілей. Кожен користувач несе відповідальність за дотримання законів у своїй юрисдикції._

---
## Розуміння транзакцій Payjoin у Bitcoin

Payjoin - це специфічна структура транзакції Bitcoin, яка покращує конфіденційність користувача під час платежу за допомогою співпраці з одержувачем платежу.

У 2015 році [LaurentMT](https://twitter.com/LaurentMT) вперше згадав цей метод як "стеганографічні транзакції" у документі, доступному [тут](https://gist.githubusercontent.com/LaurentMT/e758767ca4038ac40aaf/raw/c8125f6a3c3d0e90246dc96d3b603690ab6f1dcc/gistfile1.txt). Ця техніка пізніше була прийнята Samourai Wallet, який став першим клієнтом, що реалізував її за допомогою інструменту Stowaway у 2018 році. Концепція Payjoin також знайшла відображення у [BIP79](https://github.com/bitcoin/bips/blob/master/bip-0079.mediawiki) та [BIP78](https://github.com/bitcoin/bips/blob/master/bip-0078.mediawiki). Декілька термінів використовуються для позначення Payjoin:
- Payjoin
- Stowaway
- P2EP (Pay-to-End-Point)
- Стеганографічна транзакція

Унікальність Payjoin полягає в його здатності генерувати транзакцію, яка на перший погляд здається звичайною, але насправді є міні Coinjoin між двома сторонами. Для досягнення цього структура транзакції включає одержувача платежу поряд з фактичним відправником у входах. Одержувач включає платіж собі в середину транзакції, що дозволяє йому отримати оплату.

Давайте розглянемо конкретний приклад: якщо ви купуєте багет за `4000 сатоші`, використовуючи UTXO на `10,000 сатоші`, і вибираєте Payjoin, ваш пекар додасть UTXO на `15,000 сатоші`, яке належить їм як вхід, яке вони отримають повністю як вихід, на додаток до ваших `4000 сатоші`:
![Діаграма транзакції Payjoin](assets/en/1.webp)
У цьому прикладі, пекар вносить `15,000 сат` як вхід і отримує `19,000 сат`, з різницею рівно `4000 сат`, що є ціною багета. З вашого боку, ви вносите `10,000 сат` і закінчуєте з `6,000 сат` як вихід, що представляє баланс `-4000 сат`, що є ціною багета. Для спрощення прикладу, я навмисно опустив комісії за майнінг у цій транзакції.

## Яка мета транзакції Payjoin?

Транзакція Payjoin служить двом цілям, які дозволяють користувачам підвищити приватність своєї оплати.
Перш за все, Payjoin має на меті ввести в оману зовнішнього спостерігача, створюючи маневр у аналізі ланцюга. Це стає можливим через Гевристику Спільного Володіння Входами (CIOH). Зазвичай, коли транзакція в блокчейні має кілька входів, припускається, що всі ці входи, ймовірно, належать одній особі або користувачу. Таким чином, коли аналітик розглядає транзакцію Payjoin, він ведеться вірити, що всі входи походять від однієї людини. Однак, це сприйняття є неправильним, оскільки одержувач платежу також вносить входи поряд з фактичним платником. Таким чином, аналіз ланцюга спрямовується до інтерпретації, яка виявляється хибною.

Крім того, Payjoin також дозволяє обманювати зовнішнього спостерігача щодо фактичної суми здійсненого платежу. Розглядаючи структуру транзакції, аналітик може вважати, що платіж еквівалентний сумі одного з виходів. Однак, насправді, сума платежу не відповідає жодному з виходів. Насправді це різниця між виходом UTXO одержувача і входом UTXO одержувача. У цьому сенсі, транзакція Payjoin входить в домен стеганографії. Вона дозволяє приховувати фактичну суму транзакції в межах фальшивої транзакції, яка виступає як маневр.

> Стеганографія - це техніка приховування інформації всередині інших даних або об'єктів таким чином, що присутність прихованої інформації не є помітною. Наприклад, секретне повідомлення може бути приховане всередині крапки в тексті, який ніяк не пов'язаний з ним, роблячи його непомітним для неозброєного ока (це техніка мікропункту). На відміну від шифрування, яке робить інформацію незрозумілою без ключа дешифрування, стеганографія не змінює інформацію. Вона залишається відображеною на виду. Її мета, скоріше, приховати існування секретного повідомлення, тоді як шифрування явно виявляє присутність прихованої інформації, хоча і недоступної без ключа.

Повернімося до нашого прикладу транзакції Payjoin за оплату багета.
![Схема транзакції Payjoin ззовні](assets/en/2.webp)
Бачачи цю транзакцію в блокчейні, зовнішній спостерігач, який слідує звичайним гевристикам аналізу ланцюга, інтерпретував би її так: "*Аліса об'єднала 2 UTXO як входи транзакції, щоб заплатити `19,000 сат` Бобу*."
![Неправильна інтерпретація транзакції Payjoin ззовні](assets/en/3.webp)
Ця інтерпретація очевидно неправильна, оскільки, як ви вже знаєте, два вхідні UTXO не належать одній і тій же особі. Більше того, фактична вартість платежу не `19,000 сат`, а радше `4,000 сат`. Таким чином, аналіз зовнішнього спостерігача спрямовується до помилкового висновку, забезпечуючи збереження конфіденційності зацікавлених сторін.![схема транзакції payjoin](assets/en/1.webp)
Якщо ви бажаєте проаналізувати реальну транзакцію Payjoin, ось одна, яку я виконав на тестнеті: [8dba6657ab9bb44824b3317c8cc3f333c2f465d3668c678691a091cdd6e5984c](https://mempool.space/fr/testnet/tx/8dba6657ab9bb44824b3317c8cc3f333c2f465d3668c678691a091cdd6e5984c)
[**-> Дізнайтеся з нашого навчального посібника, як здійснити Payjoin за допомогою Samourai Wallet**](https://planb.network/tutorials/privacy/payjoin-samourai-wallet)  

[**-> Дізнайтеся з нашого навчального посібника, як здійснити Payjoin за допомогою Sparrow Wallet**](https://planb.network/tutorials/privacy/payjoin-sparrow-wallet)


**Зовнішні ресурси:**
- https://docs.samourai.io/en/spend-tools#stowaway;
- https://gist.githubusercontent.com/LaurentMT/e758767ca4038ac40aaf/raw/c8125f6a3c3d0e90246dc96d3b603690ab6f1dcc/gistfile1.txt;
- https://github.com/bitcoin/bips/blob/master/bip-0078.mediawiki.