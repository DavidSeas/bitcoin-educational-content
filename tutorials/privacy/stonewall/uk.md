---
name: Stonewall
description: Розуміння та використання транзакцій Stonewall
---
![cover stonewall](assets/cover.webp)

***УВАГА:** Після арешту засновників Samourai Wallet та конфіскації їх серверів 24 квітня, використання додатку Samourai Wallet тепер вимагає підключення до власного Dojo для належної роботи. Окрім цього, транзакції Stonewall зовсім не постраждали і можуть виконуватися без будь-яких проблем. Насправді, ці типи транзакцій здійснюються автономно, без потреби в зовнішній співпраці або підключенні через Soroban.*

_Ми уважно слідкуємо за розвитком цієї справи, а також за розвитком пов'язаних інструментів. Будьте впевнені, що ми оновимо цей навчальний посібник, як тільки з'явиться нова інформація._

_Цей навчальний посібник надається лише для освітніх та інформаційних цілей. Ми не підтримуємо або заохочуємо використання цих інструментів для кримінальних цілей. Кожен користувач несе відповідальність за дотримання законів у своїй юрисдикції._

---

> *"Руйнуйте припущення аналізу блокчейну за допомогою математично доведеного сумніву між відправником та отримувачем ваших транзакцій."*

## Що таке транзакція Stonewall?
Stonewall - це специфічна форма транзакції Bitcoin, спрямована на збільшення конфіденційності користувача під час транзакції шляхом імітації coinjoin між двома сторонами, без фактичного її виконання. Насправді, ця транзакція не є співпрацею. Користувач може створити її самостійно, використовуючи лише свої власні UTXO як вхідні дані. Таким чином, ви можете створити транзакцію Stonewall для будь-якої події без необхідності координувати дії з іншим користувачем.

Принцип дії транзакції Stonewall наступний: як вхід, відправник використовує 2 UTXO, які належать йому. Як вихід, транзакція створює 4 виходи, включаючи 2, які будуть точно однакової суми. Інші 2 будуть здачею. Серед 2 виходів однакової суми, лише один насправді піде отримувачу платежу.

У транзакції Stonewall є лише 2 ролі:
- Відправник, який здійснює фактичний платіж;
- Отримувач, який може не знати про специфіку транзакції і просто очікує платіж від відправника.

Давайте розглянемо приклад, щоб зрозуміти структуру цієї транзакції. Аліса знаходиться в булочні, щоб купити свою багету, яка коштує `4,000 сатоші`. Вона хоче заплатити біткоїнами, зберігаючи певний рівень конфіденційності у своєму платежі. Тому вона вирішує створити транзакцію Stonewall для оплати.
![transaction stonewall bakery](assets/en/1.webp)
Аналізуючи цю транзакцію, ми бачимо, що пекар дійсно отримав `4,000 сатоші` як оплату за багету. Аліса використала 2 UTXO як вхідні дані: один на `10,000 сатоші` і один на `15,000 сатоші`. Як вихід, вона отримала 3 UTXO: один на `4,000 сатоші`, один на `6,000 сатоші` і один на `11,000 сатоші`. Аліса має чистий баланс `-4,000 сатоші` в цій транзакції, що відповідає ціні багети.

У цьому прикладі я навмисно опустив комісію за майнінг для спрощення розуміння. Насправді, комісія за транзакцію повністю покривається відправником.

## Яка різниця між Stonewall та Stonewall x2?
Транзакція Stonewall працює так само, як і транзакція StonewallX2, з єдиною відмінністю, що остання вимагає співпраці, на відміну від класичної транзакції Stonewall, отже й назва "x2". Дійсно, транзакцію Stonewall можна виконати без зовнішньої співпраці: відправник може здійснити її без допомоги іншої особи. Однак, для транзакції Stonewall x2, додатковий учасник, якого називають "співпрацівником", приєднується до процесу. Співпрацівник вносить свої власні біткоїни як вхідні дані, поряд з тими, що належать відправнику, і отримує всю суму як вихідні дані (мінус комісія за майнінг).

Давайте повернемося до нашого прикладу з Алісою в пекарні. Якби вона хотіла здійснити транзакцію Stonewall x2, Алісі довелося б співпрацювати з Бобом (третьою стороною) під час створення транзакції. Кожен з них надав би вхідний UTXO. Потім Боб отримав би повну суму свого вхідного значення як вихідне. Пекар отримав би оплату за свою багету так само, як і в транзакції Stonewall, тоді як Аліса отримала б свій початковий баланс назад, мінус вартість багети.
![транзакція stonewall x2](assets/en/2.webp)

З зовнішньої точки зору, схема транзакції залишалася б точно такою ж.
![Stonewall чи Stonewall x2 ?](assets/en/3.webp)

Підсумовуючи, транзакції Stonewall і Stonewall x2 мають ідентичну структуру. Відмінність між ними полягає у їхній колаборативній природі. Транзакція Stonewall розробляється індивідуально, без потреби у співпраці. Навпаки, транзакція Stonewall x2 покладається на співпрацю між двома особами для її реалізації.

[**-> Дізнатися більше про транзакції Stonewall x2**](https://planb.network/tutorials/privacy/stonewall-x2)

## Яка мета транзакції Stonewall?
Структура Stonewall додає значну кількість ентропії до транзакції та затемнює аналіз ланцюга. З зовнішньої точки зору, таку транзакцію можна інтерпретувати як невеликий coinjoin між двома людьми. Але насправді, як і транзакція Stonewall x2, це платіж. Таким чином, цей метод створює невизначеності в аналізі ланцюга і навіть може призвести до помилкових висновків.

Давайте повернемося до прикладу Аліси в пекарні. Транзакція в блокчейні виглядала б так:
![Stonewall чи Stonewall x2 ?](assets/en/4.webp)
Зовнішній спостерігач, який покладається на загальноприйняті евристики аналізу ланцюга, міг би помилково зробити висновок, що "*дві особи виконали невеликий coinjoin, з одним UTXO кожен на вході та двома UTXO кожен на виході*".
![Stonewall чи Stonewall x2 ?](assets/en/5.webp)
Ця інтерпретація неправильна, оскільки, як ви знаєте, UTXO було відправлено пекарю, 2 UTXO на вході походять від Аліси, і вона отримала 3 змінні виходи.

![транзакція stonewall пекар](assets/en/1.webp)
Навіть якщо зовнішній спостерігач зможе ідентифікувати шаблон транзакції Stonewall, він не матиме всієї інформації. Він не зможе визначити, який з двох UTXO однакових сум відповідає платежу. Більше того, він не зможе визначити, чи два UTXO на вході походять від двох різних людей, або вони належать одній особі, яка їх об'єднала. Останній пункт пов'язаний з тим, що транзакції Stonewall x2, про які ми говорили вище, слідують точно такому ж шаблону, як і транзакції Stonewall. Ззовні і без додаткової інформації про контекст неможливо відрізнити транзакцію Stonewall від транзакції Stonewall x2. Однак, перші не є колаборативними транзакціями, тоді як останні є такими. Це додає ще більше сумнівів щодо цього витрачання.
![Stonewall чи Stonewall x2?](assets/en/3.webp)
## Як здійснити транзакцію Stonewall за допомогою Samourai Wallet?
На відміну від транзакцій Stowaway або Stonewall x2 (cahoots), для здійснення транзакції Stonewall не потрібно використовувати Paynyms. Це можна зробити безпосередньо, без будь-яких підготовчих кроків. Для цього слідуйте нашому відеоуроку про Samourai Wallet:
![Stonewall Tutorial - Samourai Wallet](https://youtu.be/mlRtZvWGuk0?si=e_lSKJLvybWUna1j)

## Як здійснити транзакцію Stonewall за допомогою Sparrow Wallet?
На відміну від транзакцій Stowaway або Stonewall x2 (cahoots), для здійснення транзакції Stonewall не потрібно використовувати Paynyms. Це можна зробити безпосередньо, без будь-яких підготовчих кроків. Для цього слідуйте нашому відеоуроку про Sparrow Wallet:
![Stonewall Tutorial - Sparrow Wallet](https://youtu.be/su89ljkV_OI?si=1jNaSJGvECUYe6Or)

**Зовнішні ресурси:**
- https://docs.samourai.io/en/spend-tools#stonewall.