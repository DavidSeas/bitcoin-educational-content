---
name: Coinjoin - Dojo
description: Як виконати coinjoin за допомогою власного Dojo?
---
![cover](assets/cover.webp)

***УВАГА:** Після арешту засновників Samourai Wallet та конфіскації їхніх серверів 24 квітня, інструмент Whirlpool більше не функціонує, навіть для осіб, які мають власний Dojo або використовують Sparrow Wallet. Однак, існує можливість, що цей інструмент може бути відновлений у найближчі тижні або запущений в іншій формі. Більше того, теоретична частина цієї статті залишається актуальною для розуміння принципів та цілей coinjoins загалом (не лише Whirlpool), а також для розуміння ефективності моделі Whirlpool.*

_Ми уважно слідкуємо за розвитком цієї справи, а також за розвитком пов'язаних інструментів. Будьте впевнені, що ми оновимо цей навчальний посібник, як тільки з'явиться нова інформація._

_Цей навчальний посібник надається лише для освітніх та інформаційних цілей. Ми не підтримуємо або заохочуємо використання цих інструментів для кримінальних цілей. Кожен користувач несе відповідальність за дотримання законів у своїй юрисдикції._

---

У цьому навчальному посібнику ви дізнаєтеся, що таке coinjoin і як його виконати, використовуючи програмне забезпечення Samourai Wallet та реалізацію Whirlpool, використовуючи власний Dojo. На мою думку, цей метод наразі є найкращим для змішування ваших біткойнів.

## Що таке coinjoin на Bitcoin?
**Coinjoin - це техніка, яка порушує простежуваність біткойнів на блокчейні**. Вона ґрунтується на спільній транзакції зі специфічною структурою однойменної: транзакції coinjoin.

Coinjoins підвищують конфіденційність користувачів Bitcoin, ускладнюючи аналіз ланцюга для зовнішніх спостерігачів. Їх структура дозволяє об'єднувати кілька монет від різних користувачів у одну транзакцію, тим самим затуманюючи сліди і ускладнюючи визначення зв'язків між вхідними та вихідними адресами.

Принцип coinjoin базується на співпраці: кілька користувачів, які бажають змішати свої біткойни, вносять однакові суми як входи однієї транзакції. Ці суми потім перерозподіляються як виходи однакової вартості кожному користувачу. В кінці транзакції стає неможливим асоціювати певний вихід з відомим користувачем на вході. Між входами та виходами не існує прямого зв'язку, що розриває асоціацію між користувачами та їхніми UTXO, а також історію кожної монети.
![coinjoin](assets/notext/1.webp)

Приклад транзакції coinjoin (не моя): [323df21f0b0756f98336437aa3d2fb87e02b59f1946b714a7b09df04d429dec2](https://mempool.space/en/tx/323df21f0b0756f98336437aa3d2fb87e02b59f1946b714a7b09df04d429dec2)

Для виконання coinjoin, забезпечуючи, що кожен користувач постійно контролює свої кошти, процес починається зі створення транзакції координатором, який потім передає її учасникам. Кожен користувач підписує транзакцію після перевірки, що вона їм підходить. Усі зібрані підписи нарешті інтегруються в транзакцію. Якщо користувач або координатор намагаються перенаправити кошти шляхом зміни виходів транзакції coinjoin, підписи виявляться недійсними, що призведе до відхилення транзакції вузлами.

Існує кілька реалізацій coinjoin, таких як Whirlpool, JoinMarket або Wabisabi, кожна з яких прагне управляти координацією серед учасників та підвищувати ефективність транзакцій coinjoin.
У цьому навчальному посібнику ми поглибимося в реалізацію **Whirlpool**, яку я вважаю найефективнішим рішенням для виконання coinjoins на Bitcoin. Хоча вона доступна в декількох гаманцях, у цьому посібнику ми виключно розглянемо її використання з мобільним додатком Samourai Wallet, без Dojo.
## Чому виконувати coinjoins на Bitcoin?
Однією з початкових проблем будь-якої системи платежів від одного користувача до іншого є подвійні витрати: як запобігти тому, щоб зловмисники не витрачали ті самі грошові одиниці кілька разів без звернення до центрального органу для арбітражу?

Сатоші Накамото запропонував рішення цієї дилеми через протокол Bitcoin, систему електронних платежів від одного користувача до іншого, яка працює незалежно від будь-якого центрального органу. У своєму білому папері він підкреслює, що єдиний спосіб засвідчити відсутність подвійних витрат - це забезпечити видимість усіх транзакцій у межах платіжної системи.

Щоб забезпечити обізнаність кожного учасника про транзакції, вони повинні бути публічно розкриті. Таким чином, робота Bitcoin залежить від прозорої та розподіленої інфраструктури, що дозволяє будь-якому оператору вузла перевіряти всю ланцюжок електронних підписів та історію кожної монети, починаючи з її створення майнером.

Прозорий та розподілений характер блокчейна Bitcoin означає, що будь-який користувач мережі може слідкувати та аналізувати транзакції всіх інших учасників. В результаті, анонімність на рівні транзакцій неможлива. Однак, анонімність зберігається на рівні ідентифікації особи. На відміну від традиційної банківської системи, де кожен рахунок пов'язаний з особистою ідентичністю, на Bitcoin кошти асоційовані з парами криптографічних ключів, таким чином надаючи користувачам форму псевдонімності за криптографічними ідентифікаторами.

Таким чином, конфіденційність на Bitcoin порушується, коли зовнішні спостерігачі вдаються до асоціації конкретних UTXO з ідентифікованими користувачами. Як тільки ця асоціація встановлена, стає можливим відстежувати їхні транзакції та аналізувати історію їхніх біткойнів. Coinjoin - це саме техніка, розроблена для розриву слідування UTXO, тим самим надаючи певний рівень конфіденційності користувачам Bitcoin на рівні транзакцій.

## Як працює Whirlpool?
Whirlpool вирізняється з інших методів coinjoin за допомогою транзакцій "_ZeroLink_", які забезпечують, що технічно неможливо створити будь-який зв'язок між усіма входами та усіма виходами. Це ідеальне змішування досягається через структуру, де кожен учасник вносить ідентичну суму на вхід (крім комісії за майнінг), таким чином генеруючи виходи абсолютно рівних сум.
Цей обмежувальний підхід до входів надає транзакціям Whirlpool coinjoin унікальну особливість: повну відсутність детермінованих зв'язків між входами та виходами. Іншими словами, кожен вихід має рівну ймовірність бути приписаним будь-якому учаснику, порівняно з усіма іншими виходами в транзакції.
Спочатку кількість учасників у кожному Whirlpool coinjoin була обмежена 5, з 2 новими учасниками та 3 реміксерами (ми пояснимо ці поняття далі). Однак, зростання комісій за транзакції в ланцюзі, спостережене в 2023 році, спонукало команди Samourai переглянути свою модель для покращення конфіденційності, знижуючи витрати. Таким чином, враховуючи ринкову ситуацію з комісіями та кількість учасників, координатор тепер може організовувати coinjoins, що включають 6, 7 або 8 учасників. Ці покращені сесії називаються "_Surge Cycles_". Важливо зазначити, що незалежно від налаштувань, у транзакціях Whirlpool завжди є лише 2 нових учасника.

Таким чином, транзакції Whirlpool характеризуються ідентичною кількістю входів та виходів, які можуть бути:
- 5 входів та 5 виходів;
![coinjoin](assets/notext/2.webp)
- 6 входів та 6 виходів;
![coinjoin](assets/notext/3.webp)
- 7 входів та 7 виходів;
![coinjoin](assets/notext/4.webp) - 8 входів та 8 виходів.
![coinjoin](assets/notext/5.webp)
Модель, запропонована Whirlpool, таким чином базується на малих транзакціях coinjoin. На відміну від Wasabi та JoinMarket, де міцність анонімних наборів залежить від обсягу учасників в одному циклі, Whirlpool робить ставку на ланцюжок кількох малих циклів.

У цій моделі користувач платить комісію лише при своєму початковому вході в пул, дозволяючи їм брати участь у безлічі реміксів без додаткових комісій. Нові учасники покривають комісії за майнінг для реміксерів.

З кожною додатковою транзакцією coinjoin, в якій бере участь монета разом з її минулими партнерами, анонімні набори будуть зростати експоненційно. Таким чином, метою є використання цих безкоштовних реміксів, які з кожним випадком сприяють збільшенню щільності анонімних наборів, асоційованих з кожною змішаною монетою.

Whirlpool було розроблено, враховуючи дві важливі вимоги:
- Доступність реалізації на мобільних пристроях, враховуючи, що Samourai Wallet переважно є додатком для смартфонів;
- Швидкість циклів реміксу для сприяння значному збільшенню анонімних наборів.
Ці імперативи керували виборами розробників Samourai Wallet у проектуванні Whirlpool, змусивши їх обмежити кількість учасників на цикл. Занадто мала кількість учасників могла б підірвати ефективність coinjoin, різко зменшивши анонімні набори, генеровані кожним циклом, тоді як занадто велика кількість учасників могла б створити проблеми управління в мобільних додатках і перешкоджати потоку циклів.
**Врешті-решт, немає потреби мати велику кількість учасників на coinjoin в Whirlpool, оскільки анонімні набори досягаються через накопичення кількох циклів coinjoin.**

[-> Дізнатися більше про анонімні набори Whirlpool.](https://planb.network/tutorials/privacy/wst-anonsets)

### Пули та комісії за coinjoin
Для того, щоб ці кілька циклів ефективно збільшували анонімні набори змішаних монет, має бути встановлений певний фреймворк для обмеження сум UTXO, що використовуються. Таким чином, Whirlpool визначає різні пули.

Пул представляє групу користувачів, які бажають змішуватися разом, домовляючись про суму UTXO для оптимізації процесу coinjoin. Кожен пул вказує фіксовану суму для UTXO, до якої користувач має дотримуватися, щоб брати участь. Таким чином, для виконання coinjoins з Whirlpool, вам потрібно вибрати пул. Наразі доступні такі пули:
- 0.5 біткоїнів;
- 0.05 біткоїна;
- 0.01 біткоїна;
- 0.001 біткоїн (= 100,000 сатоші).

Приєднуючись до пулу зі своїми біткоїнами, вони будуть поділені для генерації UTXO, які є абсолютно однорідними з тими, що мають інші учасники пулу. Кожен пул має максимальний ліміт; таким чином, для сум, що перевищують цей ліміт, вам буде змушено або зробити два окремі входи в межах того ж пулу, або перейти до іншого пулу з вищою сумою:

| Пул (біткоїн) | Максимальна сума за вхід (біткоїн) |
|----------------|------------------------------------|
| 0.5            | 35                                 |
| 0.05           | 3.5                                |
| 0.01           | 0.7                                |
| 0.001          | 0.025                              |
Як зазначалося раніше, UTXO вважається належним до пулу, коли воно готове до інтеграції у coinjoin. Однак, це не означає, що користувач втрачає володіння ним. **Протягом різних циклів міксування ви зберігаєте повний контроль над своїми ключами і, відповідно, вашими біткоїнами.** Ось що відрізняє техніку coinjoin від інших централізованих методів міксування.

Щоб увійти до пулу coinjoin, необхідно сплатити сервісні та майнінгові збори. Сервісні збори фіксовані для кожного пулу і призначені для компенсації командам, відповідальним за розробку та підтримку Whirlpool.
Сервісні збори за використання Whirlpool сплачуються лише один раз при вході до пулу. Після цього кроку у вас є можливість брати участь у необмеженій кількості реміксів без будь-яких додаткових зборів. Ось поточні фіксовані збори для кожного пулу:

| Пул (біткоїн) | Вступний збір (біткоїн) |
|---------------|-------------------------|
| 0.5           | 0.0175                  |
| 0.05          | 0.00175                 |
| 0.01          | 0.0005 (50,000 сатоші)  |
| 0.001         | 0.00005 (5,000 сатоші)  |


Ці збори по суті функціонують як вхідний квиток для обраного пулу, незалежно від суми, яку ви вкладаєте у coinjoin. Таким чином, чи ви приєднуєтеся до пулу 0.01 з точно 0.01 BTC, чи входите до нього з 0.5 BTC, збори залишаться тими самими в абсолютному значенні.

Перед тим, як приступити до coinjoins, користувач, отже, має вибір між 2 стратегіями:
- Вибрати менший пул, щоб мінімізувати сервісні збори, знаючи, що вони отримають кілька малих UTXO на виході;
- Або віддати перевагу більшому пулу, погоджуючись сплатити вищі збори, щоб отримати на виході меншу кількість UTXO більшої вартості.

Зазвичай не рекомендується об'єднувати кілька змішаних UTXO після циклів coinjoin, оскільки це може поставити під загрозу отриману конфіденційність, особливо через Евристику Спільного Володіння Входами (CIOH). Тому може бути розумно вибрати більший пул, навіть якщо це означає сплату більше, щоб уникнути наявності занадто багатьох UTXO малої вартості на виході. Користувач має зважити ці компроміси, щоб вибрати пул, який він вважає за краще.

Крім сервісних зборів, також слід враховувати майнінгові збори, притаманні будь-якій транзакції Bitcoin. Як користувач Whirlpool, вам буде потрібно сплатити майнінгові збори за підготовчу транзакцію (`Tx0`), а також за перший coinjoin. Всі наступні ремікси будуть безкоштовними, завдяки моделі Whirlpool, яка покладається на платежі нових учасників.

Дійсно, у кожному coinjoin Whirlpool два користувачі серед входів є новими учасниками. Інші входи походять від реміксерів. В результаті, майнінгові збори для всіх учасників транзакції покриваються цими двома новими учасниками, які потім також отримують можливість безкоштовних реміксів:
![coinjoin](assets/en/6.webp)
Завдяки цій системі зборів, Whirlpool дійсно відрізняється від інших сервісів coinjoin, оскільки анонімні набори UTXO не пропорційні до ціни, сплаченої користувачем. Таким чином, можливо досягти значно високих рівнів анонімності, сплативши лише вступний збір пулу та майнінгові збори за дві транзакції ( `Tx0` та початковий мікс).
Важливо зазначити, що користувач також має покрити комісію за майнінг, щоб вивести свої UTXO з пулу після завершення кількох coinjoin, якщо вони не обрали опцію `mix to`, про яку ми поговоримо в навчальному посібнику нижче.
### Рахунки HD гаманця, які використовуються Whirlpool
Для виконання coinjoin через Whirlpool, гаманець має генерувати кілька різних рахунків. Рахунок, в контексті HD (*Ієрархічно Детермінованого*) гаманця, становить секцію, повністю ізольовану від інших, ця ізоляція відбувається на третьому рівні ієрархії гаманця, тобто на рівні `xpub`.

Теоретично HD гаманець може похіднувати до `2^(32/2)` різних рахунків. Початковий рахунок, який використовується за замовчуванням у всіх гаманцях Bitcoin, відповідає індексу `0'`.

Для гаманців, адаптованих до Whirlpool, таких як Samourai або Sparrow, використовуються 4 рахунки для задоволення потреб процесу coinjoin:
- Рахунок **депозиту**, ідентифікований індексом `0'`;
- Рахунок **поганого банку** (або "doxxic change"), ідентифікований індексом `2 147 483 644'`;
- Рахунок **преміксу**, ідентифікований індексом `2 147 483 645'`;
- Рахунок **постміксу**, ідентифікований індексом `2 147 483 646'`.

Кожен з цих рахунків виконує певну функцію в межах coinjoin.

Всі ці рахунки пов'язані з одним seed, що дозволяє користувачу відновити доступ до всіх своїх біткойнів, використовуючи свою фразу відновлення і, за необхідності, свій пароль. Однак, під час цієї операції відновлення, необхідно вказати програмному забезпеченню різні індекси рахунків, які були використані.

Тепер давайте розглянемо різні етапи coinjoin в Whirlpool на цих рахунках.

### Різні етапи coinjoin на Whirlpool
**Етап 1: Tx0**
Вихідний пункт будь-якого Whirlpool coinjoin - це рахунок **депозиту**. Цей рахунок автоматично використовується, коли ви створюєте новий гаманець Bitcoin. На цей рахунок мають бути зараховані біткойни, які хочеться змішати.
`Tx0` представляє перший крок у процесі міксування Whirlpool. Його мета - підготувати та вирівняти UTXO для coinjoin, розділивши їх на одиниці, що відповідають сумі обраного пулу, для забезпечення однорідності міксування. Вирівняні UTXO потім надсилаються на рахунок **преміксу**. Що стосується різниці, яка не може увійти в пул, вона відокремлюється на специфічний рахунок: **поганий банк** (або "doxxic change").
Ця початкова транзакція `Tx0` також служить для врегулювання сервісних комісій, що належать координатору міксу. На відміну від наступних кроків, ця транзакція не є співпрацюючою; користувач, отже, має нести всі комісії за майнінг:
![coinjoin](assets/en/7.webp)

У цьому прикладі транзакції `Tx0`, вхід у `372,000 sats` з нашого рахунку **депозиту** поділяється на кілька вихідних UTXO, які розподіляються наступним чином:
- Сума `5,000 sats` призначена для координатора за сервісні комісії, що відповідає входу в пул `100,000 sats`;
- Три UTXO, підготовлені для міксування, перенаправлені на наш рахунок **преміксу** і зареєстровані у координатора. Ці UTXO вирівнюються по `108,000 sats` кожен, для покриття комісій за майнінг їхнього майбутнього початкового міксу;
- Надлишок, який не може потрапити до пулу, оскільки він занадто малий, вважається токсичною зміною. Він відправляється на свій специфічний рахунок. Тут ця зміна становить `40,000 сатс`;
- Нарешті, є `3,000 сатс`, які не є виходом, але є необхідними комісійними за майнінг, щоб підтвердити `Tx0`.

Наприклад, ось реальний Whirlpool Tx0 (не мій): [edef60744f539483d868caff49d4848e5cc6e805d6cdc8d0f9bdbbaedcb5fc46](https://mempool.space/en/tx/edef60744f539483d868caff49d4848e5cc6e805d6cdc8d0f9bdbbaedcb5fc46)

**Крок 2: Токсична зміна**
Надлишок, який не міг бути інтегрований у пул, тут еквівалентний `40,000 сатс`, перенаправляється на рахунок **поганого банку**, також відомий як "токсична зміна", щоб забезпечити строге відділення від інших UTXO в гаманці.

Цей UTXO є небезпечним для конфіденційності користувача, оскільки не тільки він все ще пов'язаний зі своїм минулим, і тому можливо з ідентичністю його власника, але додатково він позначений як належний користувачу, який виконав coinjoin.
Якщо цей UTXO буде об'єднаний з перемішаними виходами, вони втратять усю конфіденційність, отриману під час циклів coinjoin, зокрема через Common-Input-Ownership-Heuristic (CIOH). Якщо він буде об'єднаний з іншими токсичними змінами, користувач ризикує втратити конфіденційність, оскільки це пов'яже різні входи циклів coinjoin. Тому з ним потрібно поводитися обережно. Спосіб управління цим токсичним UTXO буде детально описаний у останній частині цієї статті, а майбутні навчальні посібники більш детально розкриють ці методи на мережі PlanB.

**Крок 3: Початкове змішування**
Після завершення `Tx0`, урівняні UTXO відправляються на рахунок **преміксу** нашого гаманця, готові до введення в їх перший цикл coinjoin, також відомий як "початкове змішування". Якщо, як у нашому прикладі, `Tx0` генерує кілька UTXO, призначених для змішування, кожен з них буде інтегрований у окремий початковий coinjoin.

На кінці цих перших змішувань рахунок **преміксу** буде порожнім, тоді як наші монети, сплативши комісійні за майнінг за цей перший coinjoin, будуть точно відрегульовані до суми, визначеної обраним пулом. У нашому прикладі, наші початкові UTXO `108 000 сатс` будуть зменшені до точно `100 000 сатс`.
![coinjoin](assets/en/8.webp)
**Крок 4: Ремікси**
Після початкового змішування UTXO переводяться на рахунок **постміксу**. Цей рахунок збирає вже змішані UTXO та ті, що чекають на ремікс. Коли клієнт Whirlpool активний, UTXO, розташовані на рахунку **постміксу**, автоматично доступні для реміксу і будуть випадково обрані для участі в цих нових циклах.

Нагадуємо, що ремікси потім є абсолютно безкоштовними: не потрібно додаткових сервісних зборів або комісійних за майнінг. Зберігання UTXO на рахунку **постміксу** таким чином зберігає їхню цінність незмінною і одночасно покращує їх anonsets. Тому важливо дозволити цим монетам брати участь у кількох циклах coinjoin. Це не коштує вам абсолютно нічого, і це збільшує їх рівні анонімності.
Коли ви вирішуєте витратити змішані UTXO, ви можете зробити це безпосередньо з цього **постмікс** акаунту. Рекомендується зберігати змішані UTXO в цьому акаунті, щоб скористатися безкоштовними реміксами та уникнути їх виходу з циклу Whirlpool, що могло б зменшити їх конфіденційність.
Як ми побачимо в наступному навчальному посібнику, існує також опція `mix to`, яка пропонує можливість автоматично відправляти ваші змішані монети до іншого гаманця, наприклад, холодного гаманця, після визначеної кількості coinjoins.
Після теоретичної частини, давайте перейдемо до практики з навчальним посібником з використання Whirlpool через додаток Samourai Wallet для Android, синхронізованим з Whirlpool CLI та GUI на вашому власному Dojo!
## Навчальний посібник: Coinjoin Whirlpool з вашим власним Dojo
Існує багато варіантів використання Whirlpool. Той, який я хочу тут представити, - це опція Samourai Wallet, відкритий додаток для управління Bitcoin гаманцем на Android, але цього разу **з вашим власним Dojo**.

Виконання coinjoins через Samourai Wallet, використовуючи ваш власний Dojo, на мою думку, є найефективнішою стратегією проведення coinjoins на Bitcoin на сьогоднішній день. Цей підхід вимагає певних початкових інвестицій з точки зору налаштування, але, як тільки все на місці, він пропонує можливість змішувати та реміксувати ваші біткоїни безперервно, 24 години на добу, 7 днів на тиждень, без необхідності постійно тримати активним додаток Samourai. Дійсно, завдяки роботі Whirlpool CLI на вузлі Bitcoin, ви завжди готові брати участь у coinjoins. Додаток Samourai потім дає вам можливість витрачати ваші змішані кошти в будь-який час, де б ви не були, безпосередньо з вашого смартфона. Більше того, цей метод має перевагу ніколи не підключати вас до серверів, керованих командами Samourai, таким чином зберігаючи ваш `xpub` від будь-якого зовнішнього впливу.

Ця техніка, отже, ідеально підходить для тих, хто шукає максимальну приватність та найвищу якість циклів coinjoin. Однак, вона вимагає наявності Bitcoin вузла у вашому розпорядженні і, як ми побачимо пізніше, потребує деякого налаштування. Таким чином, вона більше підходить для користувачів середнього та високого рівня. Для початківців я рекомендую ознайомитися з coinjoin через ці два інші навчальні посібники, які показують, як це зробити з Sparrow Wallet або Samourai Wallet (без Dojo):
- **[Навчальний посібник по coinjoin з Sparrow Wallet](https://planb.network/en/tutorials/privacy/coinjoin-sparrow-wallet)**;
- **[Навчальний посібник по coinjoin з Samourai Wallet (без Dojo)](https://planb.network/en/tutorials/privacy/coinjoin-samourai-wallet)**.

### Розуміння налаштування
Для початку, вам знадобиться Dojo! Dojo - це реалізація Bitcoin вузла на основі Bitcoin Core, розроблена командами Samourai.

Щоб запустити свій власний Dojo, у вас є можливість або встановити вузол Dojo автономно, або скористатися перевагами Dojo на основі іншого рішення "вузол-в-коробці" для Bitcoin вузла. Наразі доступні такі варіанти:
- [RoninDojo](https://ronindojo.io/), який є Dojo з додатковими інструментами, включаючи помічника з установки та помічника з адміністрування. Я детально описую процедуру налаштування та використання RoninDojo в цьому іншому навчальному посібнику: [RONINDOJO V2](https://planb.network/en/tutorials/node/ronin-dojo-v2);
- [Umbrel](https://umbrel.com/) з додатком "Samourai Server";
- [MyNode](https://mynodebtc.com/) з додатком "Dojo";
- [Nodl](https://www.nodl.eu/) з додатком "Dojo";
- [Citadel](https://runcitadel.space/) з додатком "Samourai".
![coinjoin](assets/notext/9.webp)
У нашій налаштуванні ми будемо взаємодіяти з трьома різними інтерфейсами:
- **Samourai Wallet**, який буде містити наш Bitcoin гаманець, призначений для coinjoins. Доступний безкоштовно на Android, цей додаток FOSS дозволяє вам контролювати ваш міксуючий гаманець, особливо для витрачання ваших постміксів зі смартфона;
- **Whirlpool CLI** (_Командний Рядок Інтерфейс_), який буде працювати на вузлі, що містить Dojo. Це програмне забезпечення матиме доступ до ключів вашого Samourai гаманця. Воно відповідає за комунікацію з координатором та управління coinjoins безперервно. Воно діє як копія вашого Samourai гаманця на вашому вузлі, готового до участі в coinjoins в будь-який час;
- **Whirlpool GUI** (_Графічний Інтерфейс Користувача_), графічний інтерфейс, який ми будемо використовувати для моніторингу активності Whirlpool CLI та ініціювання міксування дистанційно. Whirlpool GUI надає візуальне представлення операцій, проведених Whirlpool CLI. Це програмне забезпечення має бути встановлене на комп'ютері, окремому від Dojo. Для користувачів Umbrel, MyNode, Nodl і Citadel, Whirlpool GUI є обов'язковим. Однак, з RoninDojo, інтерфейс Whirlpool GUI вже інтегрований у веб-інтерфейс вашого вузла через додаток `Whirlpool`. Тому вам не потрібно буде встановлювати його на окремий ПК.

На мою думку, використання RoninDojo представляє найкраще рішення для виконання coinjoins з Dojo. Оскільки це програмне забезпечення для вузла в коробці має пряме партнерство з командами Samourai, RoninDojo набагато оптимізованіше для цього. Більше того, інтеграція Whirlpool GUI в веб-інтерфейс значно спрощує процес налаштування. У цьому навчальному посібнику я все ж таки поясню, як це зробити з іншими рішеннями, що інтегрують Dojo (Umbrel, Nodl, MyNode і Citadel).

### Підготовка вашого Dojo
Для початку вам потрібно буде встановити Dojo та отримати QR-код або посилання, яке дозволить вам підключитися до нього дистанційно. Це посилання є адресою Tor, що закінчується на `.onion`. Якщо ви використовуєте RoninDojo, просто перейдіть до меню `Pairing`, щоб отримати цю інформацію.
![coinjoin](assets/notext/10.webp)

Нижче `Samourai Dojo` натисніть на кнопку `Pair now`.

![coinjoin](assets/notext/11.webp)

Буде відображено ваш QR-код для підключення та відповідне посилання.

![coinjoin](assets/notext/12.webp)

Якщо ви на Umbrel, перейдіть до App Store та шукайте додаток `Samourai Server`. Він розташований у вкладці `Bitcoin`.

![coinjoin](assets/notext/13.webp)

Встановіть додаток.

![coinjoin](assets/notext/14.webp)

Після відкриття додатку ви тоді матимете доступ до QR-коду для підключення до вашого Dojo.

![coinjoin](assets/notext/15.webp)

Якщо ви використовуєте інше програмне забезпечення для вузла в коробці, таке як MyNode, Citadel або Nodl, процес схожий на той, що в Umbrel. Вам потрібно встановити додаток Samourai або Dojo, щоб отримати необхідну інформацію для підключення до вашого Dojo.

![coinjoin](assets/notext/16.webp)

### Підготовка вашого Samourai Wallet
Після отримання інформації для підключення до вашого Dojo, настав час налаштувати ваш гаманець для coinjoins. Існують два сценарії: якщо у вас ще немає Samourai Wallet на вашому смартфоні, процес простий, просто створіть новий.
З іншого боку, якщо у вас вже є Samourai Wallet, вам потрібно буде перевстановити додаток, щоб асоціювати його з новим Dojo. Цей крок необхідний, оскільки підключення до Dojo може бути встановлено лише при першому запуску додатку. Однак, завдяки автоматично створеному зашифрованому файлу резервної копії Samourai на вашому телефоні, ця процедура проста і швидка.

*Якщо ви ніколи не користувалися Samourai, ви можете пропустити ці попередні кроки і перейти безпосередньо до встановлення додатку.*

Перш за все, переконайтеся, що ваш додаток Samourai Wallet оновлено. Для цього перевірте Google Play Store або порівняйте версію вашого додатку в `Settings > Other` з доступною на сайті Samourai.

![coinjoin](assets/notext/17.webp)

Переконайтеся, що у вас є фраза відновлення вашого гаманця Samourai і що вона читабельна. Потім проведіть тест вашої фрази BIP39, перейшовши до `Settings > Troubleshoot > Passphrase/Backup test`, щоб підтвердити її точність.

![coinjoin](assets/notext/18.webp)
Введіть вашу фразу, а потім перевірте, що Samourai підтверджує її валідність.
![coinjoin](assets/notext/19.webp)

Якщо ваша фраза недійсна, або якщо у вас немає вашої фрази відновлення, негайно зупиніть процедуру! **Ви ризикуєте втратити свої біткоїни під час цієї операції.** У цьому випадку рекомендується перевести ваші кошти в інший гаманець і почати з нового порожнього Samourai гаманця. Наступні кроки слід виконувати лише якщо ви впевнені, що маєте всю необхідну інформацію для резервного копіювання і що ваша фраза дійсна.

Далі приступіть до створення зашифрованої резервної копії вашого гаманця і скопіюйте її в буфер обміну. Для виконання цієї операції натисніть на три маленькі точки, розташовані в правому верхньому куті екрана, а потім виберіть `Export wallet backup`.

![coinjoin](assets/notext/20.webp)

**З цього кроку не копіюйте нічого іншого до вашого буфера обміну!** Абсолютно важливо зберегти вашу скопійовану резервну копію.

Якщо ви правильно виконали попередні кроки, тепер ви можете безпечно видалити ваш Samourai гаманець. Для цього перейдіть до: `Settings > Wallet > Secure erase the wallet`.

![coinjoin](assets/notext/21.webp)

![coinjoin](assets/notext/22.webp)

*Якщо ви ніколи не користувалися Samourai і встановлюєте додаток з нуля, ви можете продовжити навчальний посібник з цього кроку.*

Ваш додаток Samourai тепер скинуто. Відкрийте додаток і приступіть до кроків налаштування, ніби ви використовуєте його вперше.

![coinjoin](assets/notext/23.webp)

На наступному кроці ви отримаєте доступ до сторінки, присвяченої налаштуванню вашого Dojo. Виберіть опцію `Dojo`, а потім введіть інформацію для входу вашого Dojo. Для цього у вас є можливість відсканувати інформацію, натиснувши `Scan QR`.

![coinjoin](assets/notext/24.webp)

*Для нових користувачів Samourai, потім буде необхідно створити гаманець з нуля. Якщо вам потрібна допомога, ви можете ознайомитися з інструкціями з налаштування нового Samourai гаманця [в цьому навчальному посібнику, зокрема в розділі "Створення програмного гаманця"](https://planb.network/tutorials/privacy/coinjoin-samourai-wallet)*
Якщо ви продовжуєте відновлення вже існуючого гаманця Samourai, виберіть `Відновити існуючий гаманець`, потім оберіть `У мене є файл резервної копії Samourai`.
![coinjoin](assets/notext/25.webp)
Зазвичай, ви завжди повинні мати файл відновлення у вашому буфері обміну. Потім натисніть на `ВСТАВИТИ`, щоб вставити ваш файл у відведене місце. Для розшифровки також буде необхідно ввести фразу-пароль BIP39 вашого гаманця у відповідне поле, розташоване нижче. Для завершення натисніть на `ЗАВЕРШИТИ`.
![coinjoin](assets/notext/26.webp)

Після цього ви будете перенаправлені до вашого гаманця Samourai, який цього разу буде підключений до вашого власного Dojo.

![coinjoin](assets/notext/27.webp)

### Встановлення Whirlpool GUI
Тепер настав час встановити Whirlpool GUI, графічний інтерфейс користувача, який дозволить вам керувати вашими циклами coinjoin з вашого звичайного ПК. Для користувачів RoninDojo цей крок не є необхідним, оскільки керування coinjoins може здійснюватися безпосередньо через веб-інтерфейс у `Додатки > Whirlpool`. Однак, якщо ви використовуєте інше рішення Bitcoin "node-in-box", обов'язково потрібно пройти це встановлення.
![coinjoin](assets/notext/28.webp)
Перейдіть на ваш особистий комп'ютер і завантажте програмне забезпечення Whirlpool з офіційного сайту Samourai Wallet, вибравши версію, яка відповідає вашій операційній системі.

![coinjoin](assets/notext/29.webp)

Перед запуском Whirlpool GUI необхідно встановити JAVA 8 або вищу версію на вашу машину. Для цього [ви можете встановити OpenJDK](https://adoptium.net/).
![coinjoin](assets/notext/30.webp)
Також необхідно, щоб Tor Daemon або Tor Browser працювали у фоновому режимі на вашому комп'ютері. Переконайтеся, що ви запустили Tor перед кожною сесією використання Whirlpool GUI. Якщо Tor ще не встановлено на вашій машині, [ви можете завантажити та встановити його з офіційного сайту проекту](https://www.torproject.org/download/), а потім переконайтеся, що ви запустили його у фоновому режимі.

![coinjoin](assets/notext/31.webp)

Одразу після встановлення JDK на вашу систему та запуску Tor у фоновому режимі, ви можете запустити Whirlpool GUI.

![coinjoin](assets/notext/32.webp)

У Whirlpool GUI натисніть на `Розширено: Віддалений CLI`, щоб підключити ваш Whirlpool CLI, який знаходиться на вашому Dojo. Вам знадобиться Tor адреса вашого Whirlpool CLI.

![coinjoin](assets/notext/33.webp)

Щоб знайти вашу Tor адресу на Umbrel та інших рішеннях "node-in-box", просто запустіть додаток Samourai Server або Dojo (назва може варіюватися залежно від використовуваного програмного забезпечення). Tor адреса буде безпосередньо видима на сторінці додатка.
![coinjoin](assets/notext/34.webp)
У Whirlpool GUI введіть Tor адресу, яку ви отримали раніше, у поле `CLI адреса`. Залиште префікс `http://`, але не додавайте порт `:8899` в кінці. Вставте лише адресу так, як вона була надана вам.
![coinjoin](assets/notext/35.webp)
У полі Tor Proxy введіть `socks5://127.0.0.1:9050`, якщо ви використовуєте Tor Daemon, або `socks5://127.0.0.1:9150`, якщо це Tor Browser. Коли ви вперше підключаєтесь до Whirlpool CLI через Whirlpool GUI, можна залишити поле ключа API порожнім. Якщо це не ваше перше підключення, будь ласка, введіть ваш ключ API у відведене місце. Цей ключ можна знайти на тій же сторінці, що й ваша адреса Tor.
![coinjoin](assets/notext/36.webp)

Після того, як ви заповнили все, натисніть кнопку `Connect`. Будь ласка, зачекайте, підключення може зайняти кілька хвилин.

![coinjoin](assets/notext/37.webp)

### Парування вашого Samourai Wallet з Whirlpool GUI
*Для користувачів RoninDojo, ви можете продовжити навчання тут.*

Тепер ми спаримо гаманець Samourai, який ми налаштували раніше, з програмним забезпеченням Whirlpool GUI, або безпосередньо з RoninDojo для тих, хто використовує це програмне забезпечення. Незалежно від того, використовуєте ви Whirlpool GUI чи RoninDojo, вам буде запропоновано вставити або відсканувати інформацію про парування вашого гаманця Samourai.

![coinjoin](assets/notext/38.webp)

Щоб знайти цю інформацію, перейдіть до налаштувань вашого гаманця.

![coinjoin](assets/notext/39.webp)

Натисніть на `Transactions`, потім на `Pair to Whirlpool GUI`.

![coinjoin](assets/notext/40.webp)

Samourai надасть вам необхідну інформацію для встановлення з'єднання. Будьте обережні, ці дані є конфіденційними! Ви можете передати їх на свій ПК, скопіювавши їх безпосередньо або відсканувавши QR-код, відображений на екрані, використовуючи веб-камеру вашого комп'ютера після натискання на символ QR-коду.

![coinjoin](assets/notext/41.webp)

Після виконання цієї операції у Whirlpool GUI виберіть `Initialize GUI`. Будь ласка, зачекайте, оскільки цей крок може зайняти деякий час.

![coinjoin](assets/notext/42.webp)

Незалежно від того, використовуєте ви Whirlpool GUI чи RoninDojo, вам буде запропоновано ввести парольну фразу вашого гаманця Samourai. Введіть її у відведене поле, а потім натисніть кнопку `Login`, щоб продовжити.

![coinjoin](assets/notext/43.webp)

Після цього ви потрапите на домашню сторінку Whirlpool CLI

![coinjoin](assets/notext/44.webp)

### Ініціювання coinjoins з Whirlpool GUI
*Для користувачів RoninDojo процес слідування є ідентичним. Інтерфейс додатку Whirlpool, інтегрований у RoninDojo, пропонує ті ж опції та функціональні можливості, що й програмне забезпечення Whirlpool GUI на комп'ютері. Тому ви можете слідувати цим інструкціям так само.*
Тепер, коли все налаштовано, ви готові почати міксувати свої біткойни. Для цього переведіть біткойни, які ви хочете змішати, на рахунок **Deposit** вашого гаманця Samourai. Цю операцію можна виконати або безпосередньо через додаток Samourai Wallet, або через Whirlpool GUI. З головної сторінки натисніть кнопку `+ Deposit`, розташовану в лівому верхньому куті.

![coinjoin](assets/notext/45.webp)
Whirlpool GUI згенерує адресу для отримання. Також тут буде відображено мінімальну суму, необхідну для участі в кожному пулі coinjoin. Ця сума змінюється залежно від ринку комісій. Рекомендується внести суму трохи вищу, ніж мінімально необхідна, оскільки якщо комісії за майнінг не зменшаться, ваш UTXO може не бути прийнятий у бажаний пул. Тому надішліть свої біткоїни на надану адресу. Щоб отримати нову адресу, просто натисніть кнопку `Оновити адресу`.
![coinjoin](assets/notext/46.webp)

Як тільки депозит буде підтверджено, ви зможете побачити його у рахунку **Депозит** на Whirlpool GUI.

![coinjoin](assets/notext/47.webp)

Щоб розпочати цикли coinjoin, виберіть UTXO, які ви хочете змішати, і натисніть кнопку `Премікс`. Будьте обережні: якщо ви виберете кілька різних UTXO одночасно, вони будуть об'єднані під час підготовчої транзакції `TX0`. Це об'єднання може призвести до зниження конфіденційності, особливо якщо UTXO походять з різних джерел, через евристику спільного володіння входами (CIOH).

![coinjoin](assets/notext/48.webp)

Відкривається сторінка налаштувань Whirlpool. Ви можете вибрати пул, до якого хочете приєднатися. Також виберіть комісії за майнінг, призначені для `TX0` та перших coinjoins. Внизу цієї сторінки буде представлено підсумок з сумою doxxic зміни, а також сумою та кількістю UTXO, які будуть урівняні та включені в цикли coinjoin. Якщо ви задоволені цією конфігурацією, натисніть кнопку `Премікс`, щоб розпочати цикли coinjoin.
![coinjoin](assets/notext/49.webp)

Після створення `TX0` ви зможете побачити свої урівняні UTXO на рахунку **Премікс**, чекаючи на підтвердження. Щоб дозволити вашим монетам автоматично змішуватися 24 години на добу, 7 днів на тиждень, я рекомендую активувати опцію `Автоматично змішувати премікс & постмікс`. Цю функцію ви знайдете на вкладці `Конфігурація`, розташованій ліворуч від вікна Whirlpool GUI.
![coinjoin](assets/notext/50.webp)
Після початку coinjoins ви можете вийти з Whirlpool GUI, а також з Samourai Wallet. Лише ваш вузол повинен залишатися підключеним, щоб мати можливість брати участь у безперервних coinjoins. Однак рекомендується періодично перевіряти прогрес ваших циклів coinjoin. Якщо ви помітите, що ваші UTXO більше не вибираються для coinjoin протягом деякого часу, це може вказувати на помилку. У цьому випадку перейдіть до Whirlpool CLI та виберіть `Старт`, щоб відновити вашу доступність для coinjoins.

![coinjoin](assets/notext/51.webp)

Ваші змішані UTXO видно з рахунку **Постмікс** на Whirlpool GUI. Крім того, у вас є можливість переглядати та витрачати їх безпосередньо через інтерфейс Whirlpool у вашому Samourai Wallet. Щоб отримати доступ до цього меню, натисніть на синій `+` внизу вашого екрану, потім виберіть `Whirlpool`.

![coinjoin](assets/notext/52.webp)

Рахунки Whirlpool легко ідентифікувати в Samourai Wallet за їх синім кольором. Це дозволяє вам витрачати ваші змішані UTXO з будь-якого місця та в будь-який час, безпосередньо з вашого смартфона.

![coinjoin](assets/notext/53.webp)
Щоб стежити за вашими автоматичними coinjoins, я також рекомендую налаштувати гаманець тільки для перегляду через додаток Sentinel. Додайте ZPUB вашого акаунту **Postmix** та спостерігайте за прогресом ваших циклів coinjoin в реальному часі. Якщо ви хочете зрозуміти, як користуватися Sentinel, я рекомендую проконсультуватися з цим іншим навчальним посібником на PlanB Network: [**SENTINEL WATCH-ONLY**](https://planb.network/tutorials/wallet/sentinel)